# ๐ ุฏููู ุชุทุจูู ูุธุงู ุงูุญูููุฉ - ERB VitaSlims

## ๐ฆ ุงููููุงุช ุงููุทููุจุฉ

- โ `lib/data-visibility-control.ts` - ูุธุงู ุงูุญูููุฉ ุงูุฃุณุงุณู
- โ `lib/validation.ts` - ุฏูุงู ุงูุชุญูู ูุงูุตูุงุญูุงุช
- โ `app/api/sales-orders/route.ts` - API ุฃูุงูุฑ ุงูุจูุน
- โ `app/api/invoices/route.ts` - API ุงูููุงุชูุฑ
- โ `update-governance-data.sql` - ุชุญุฏูุซ ุงูุจูุงูุงุช ุงููุฏููุฉ
- โ `apply-governance-updates.ps1` - ุณูุฑูุจุช ุงูุชุทุจูู
- โ `TESTING_GUIDE.md` - ุฏููู ุงูุงุฎุชุจุงุฑ

## ๐ ุฎุทูุงุช ุงูุชุทุจูู

### ุงููุฑุญูุฉ 1: ุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช

```bash
# 1. ุชุดุบูู ุณูุฑูุจุช ุงูุชุญุฏูุซ
.\apply-governance-updates.ps1

# 2. ูุณุฎ ูุญุชูู update-governance-data.sql
# 3. ุชูููุฐู ูู Supabase Dashboard > SQL Editor
```

### ุงููุฑุญูุฉ 2: ุงูุชุญูู ูู ุงูุชุญุฏูุซุงุช

```sql
-- ุชุญูู ูู ุฃู ุฌููุน ุงูุณุฌูุงุช ูุฏููุง ุจูุงูุงุช ุญูููุฉ
SELECT 
  'sales_orders' as table_name,
  COUNT(*) as total,
  COUNT(branch_id) as with_branch,
  COUNT(warehouse_id) as with_warehouse
FROM sales_orders
UNION ALL
SELECT 
  'invoices',
  COUNT(*),
  COUNT(branch_id),
  COUNT(warehouse_id)
FROM invoices;
```

### ุงููุฑุญูุฉ 3: ุงุฎุชุจุงุฑ ุงููุธุงู

ุงุชุจุน ุฏููู ุงูุงุฎุชุจุงุฑ ูู `TESTING_GUIDE.md`

## ๐ ูุณุชููุงุช ุงูุญูููุฉ

```
Company (ุงูุดุฑูุฉ)
  โโโ Branch (ุงููุฑุน)
       โโโ Cost Center (ูุฑูุฒ ุงูุชูููุฉ)
            โโโ Warehouse (ุงููุฎุฒู)
                 โโโ Created By User (ุงูููุดุฆ)
```

## ๐ ุตูุงุญูุงุช ุงูุฃุฏูุงุฑ

| ุงูุฏูุฑ | ุฃูุงูุฑ ุงูุจูุน | ุงูููุงุชูุฑ | ุงูููุงุชุฑ |
|------|-------------|----------|---------|
| Staff | ุฃูุงูุฑู ููุท | ููุงุชูุฑู ููุท | - |
| Accountant | ูู ุงููุฑุน | ูู ุงููุฑุน | ุญุณุจ ุงูููุธู |
| Manager | ูู ุงููุฑุน | ูู ุงููุฑุน | ุญุณุจ ุงูููุธู |
| Owner/Admin | ูู ุงูุดุฑูุฉ | ูู ุงูุดุฑูุฉ | ุญุณุจ ุงููุฑุน ูุงูููุธู |

## ๐ฏ API Endpoints

### ุฃูุงูุฑ ุงูุจูุน
```
GET  /api/sales-orders  - ุฌูุจ ุฃูุงูุฑ ุงูุจูุน (ูุน ุงูุญูููุฉ)
POST /api/sales-orders  - ุฅูุดุงุก ุฃูุฑ ุจูุน (ูุน ุงูุญูููุฉ)
```

### ุงูููุงุชูุฑ
```
GET  /api/invoices      - ุฌูุจ ุงูููุงุชูุฑ (ูุน ุงูุญูููุฉ)
```

## โ ูุงุฆูุฉ ุงูุชุญูู

- [ ] ุชูููุฐ SQL ูุชุญุฏูุซ ุงูุจูุงูุงุช ุงููุฏููุฉ
- [ ] ุงูุชุญูู ูู ุฃู ุฌููุน ุงูุณุฌูุงุช ูุฏููุง branch_id
- [ ] ุงูุชุญูู ูู ุฃู ุฌููุน ุงูุณุฌูุงุช ูุฏููุง warehouse_id
- [ ] ุงุฎุชุจุงุฑ ุฏูุฑ Staff
- [ ] ุงุฎุชุจุงุฑ ุฏูุฑ Accountant
- [ ] ุงุฎุชุจุงุฑ ุฏูุฑ Manager
- [ ] ุงุฎุชุจุงุฑ ุฏูุฑ Owner/Admin
- [ ] ุงุฎุชุจุงุฑ ุฅูุดุงุก ุฃูุฑ ุจูุน ุฌุฏูุฏ
- [ ] ุงุฎุชุจุงุฑ ุงูุชุญููู ููุงุชูุฑุฉ
- [ ] ุงูุชุญูู ูู Audit Trail

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ุชุธูุฑ ุฃูุงูุฑ ุงูุจูุน
**ุงูุญู**: ุชุญูู ูู:
1. ูู ุงููุณุชุฎุฏู ูุฏูู company_id ุตุญูุญุ
2. ูู ุงููุณุชุฎุฏู ูุฏูู branch_id ูู company_membersุ
3. ูู ุฃูุงูุฑ ุงูุจูุน ูุฏููุง branch_id ุตุญูุญุ

### ุงููุดููุฉ: ุงูููุธู ูุฑู ุฃูุงูุฑ ุงูุขุฎุฑูู
**ุงูุญู**: ุชุญูู ูู:
1. ูู API ูุทุจู ููุชุฑ created_by_user_idุ
2. ูู ุงูุฏูุฑ ุตุญูุญ ูู company_membersุ

### ุงููุดููุฉ: ุงููุฏูุฑ ูุง ูุฑู ูู ุฃูุงูุฑ ุงููุฑุน
**ุงูุญู**: ุชุญูู ูู:
1. ูู ุฌููุน ุงูุฃูุงูุฑ ูุฏููุง branch_idุ
2. ูู ุงููุฏูุฑ ูุฏูู branch_id ุตุญูุญุ
3. ูู API ูุทุจู ููุชุฑ branch_id ุจุดูู ุตุญูุญุ

## ๐ ุงูุฏุนู

ูููุณุงุนุฏุฉ ุฃู ุงูุฅุจูุงุบ ุนู ูุดุงููุ ุฑุงุฌุน:
- `GOVERNANCE_REVIEW.md` - ูุฑุงุฌุนุฉ ุดุงููุฉ
- `TESTING_GUIDE.md` - ุฏููู ุงูุงุฎุชุจุงุฑ
- `update-governance-data.sql` - SQL ููุชุญุฏูุซุงุช

---

**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุชุทุจูู
**ุขุฎุฑ ุชุญุฏูุซ**: 2024
