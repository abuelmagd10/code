# ๐๏ธ ููุฒุฉ ุญุฐู ุทูุจุงุช ุงูููู (Delete Transfer Feature)

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุฅููุงููุฉ ุญุฐู ุทูุจุงุช ููู ุงููุฎุฒูู ุงูุชู ูู ุญุงูุฉ **pending** (ููุฏ ุงูุงูุชุธุงุฑ) ููุทุ ูุน ุงูุญูุงุธ ุนูู ุจุงูู ุงูููุท ูุงูุตูุงุญูุงุช.

---

## โ ุงูุชุบููุฑุงุช ุงููููุฐุฉ

### 1๏ธโฃ ุตูุญุฉ ุชูุงุตูู ุทูุจ ุงูููู (`app/inventory-transfers/[id]/page.tsx`)

#### ุงูุฅุถุงูุงุช:
1. โ ุงุณุชูุฑุงุฏ ุฃููููุฉ `Trash2` ูู lucide-react
2. โ ุฅุถุงูุฉ ูุชุบูุฑ `canDelete` ููุชุญูู ูู ุตูุงุญูุฉ ุงูุญุฐู
3. โ ุฅุถุงูุฉ ุฏุงูุฉ `handleDelete` ูุญุฐู ุทูุจ ุงูููู
4. โ ุฅุถุงูุฉ ุฒุฑ "ุญุฐู" ูู ูุงุฌูุฉ ุงููุณุชุฎุฏู

#### ุงูููุฏ:

```typescript
// ๐ ุตูุงุญูุฉ ุงูุญุฐู: Owner/Admin/Manager ููุทุ ูููุท ูู ุญุงูุฉ pending
const canDelete = canManage && transfer?.status === 'pending'

// ๐๏ธ ุญุฐู ุทูุจ ุงูููู (ููุท ูู ุญุงูุฉ pending)
const handleDelete = async () => {
  if (!transfer) return

  // ุงูุชุฃููุฏ ูู ุงููุณุชุฎุฏู
  if (!confirm(appLang === 'en' 
    ? 'Are you sure you want to delete this transfer request? This action cannot be undone.' 
    : 'ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุทูุจ ุงูููู ูุฐุงุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐุง ุงูุฅุฌุฑุงุก.')) {
    return
  }

  try {
    setIsProcessing(true)

    const response = await fetch('/api/delete-transfers', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        transfer_numbers: [transfer.transfer_number]
      })
    })

    const data = await response.json()

    if (!response.ok) {
      throw new Error(data.error || 'Failed to delete transfer')
    }

    toast({
      title: appLang === 'en' ? 'Transfer Deleted' : 'ุชู ุญุฐู ุทูุจ ุงูููู',
      description: appLang === 'en' ? 'Transfer request deleted successfully' : 'ุชู ุญุฐู ุทูุจ ุงูููู ุจูุฌุงุญ'
    })

    router.push('/inventory-transfers')
  } catch (error: any) {
    console.error('Error deleting transfer:', error)
    toast({
      title: appLang === 'en' ? 'Error' : 'ุฎุทุฃ',
      description: error?.message || (appLang === 'en' ? 'Failed to delete transfer' : 'ูุดู ุญุฐู ุทูุจ ุงูููู'),
      variant: 'destructive'
    })
  } finally {
    setIsProcessing(false)
  }
}
```

#### ุฒุฑ ุงูุญุฐู ูู ุงููุงุฌูุฉ:

```tsx
{/* ๐๏ธ ุญุฐู ุทูุจ ุงูููู - ููุท ูู ุญุงูุฉ pending */}
{canDelete && (
  <Button variant="destructive" onClick={handleDelete} disabled={isProcessing} className="gap-2">
    <Trash2 className="w-4 h-4" />
    {appLang === 'en' ? 'Delete' : 'ุญุฐู'}
  </Button>
)}
```

---

### 2๏ธโฃ ุงูุชูุซูู (`docs/INVENTORY_TRANSFERS_PERMISSIONS.md`)

#### ุงูุชุญุฏูุซุงุช:
1. โ ุฅุถุงูุฉ ุตูุงุญูุฉ ุงูุญุฐู ูู Owner/Admin/Manager
2. โ ุฅุถุงูุฉ ูุณู ูุงูู ุนู "ุญุฐู ุทูุจุงุช ุงูููู"
3. โ ุฅุถุงูุฉ ุฃูุซูุฉ ุนูููุฉ ููุญุฐู

---

## ๐ ุงูุตูุงุญูุงุช

### ูู ููููู ุงูุญุฐูุ
- โ **Owner**
- โ **Admin**
- โ **Manager**
- โ **Store Manager** (ูุง ููููู ุงูุญุฐู)
- โ **Staff** (ูุง ููููู ุงูุญุฐู)

### ูุชู ูููู ุงูุญุฐูุ
- โ ููุท ุนูุฏูุง ูููู ุงูุทูุจ ูู ุญุงูุฉ **pending**
- โ ูุง ูููู ุญุฐู ุทูุจ ูู ุญุงูุฉ `in_transit`
- โ ูุง ูููู ุญุฐู ุทูุจ ูู ุญุงูุฉ `received`

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### โ ูุซุงู 1: ุญุฐู ูุงุฌุญ
**ุงูุณููุงุฑูู:**
- ุทูุจ ููู: `TRF-001`
- ุงูุญุงูุฉ: `pending`
- ุงููุณุชุฎุฏู: `ูุฏูุฑ`

**ุงููุชูุฌุฉ:**
- โ ูุธูุฑ ุฒุฑ "ุญุฐู"
- โ ุนูุฏ ุงูุถุบุทุ ูุทูุจ ุชุฃููุฏ
- โ ุจุนุฏ ุงูุชุฃููุฏุ ูุชู ุญุฐู ุงูุทูุจ
- โ ูุชู ุฅุนุงุฏุฉ ุงูุชูุฌูู ุฅูู `/inventory-transfers`

---

### โ ูุซุงู 2: ุญุฐู ูุฑููุถ (ุญุงูุฉ ุฎุงุทุฆุฉ)
**ุงูุณููุงุฑูู:**
- ุทูุจ ููู: `TRF-002`
- ุงูุญุงูุฉ: `in_transit`
- ุงููุณุชุฎุฏู: `Owner`

**ุงููุชูุฌุฉ:**
- โ ูุง ูุธูุฑ ุฒุฑ "ุญุฐู"
- โน๏ธ ุงูุณุจุจ: ุงูุทูุจ ููุณ ูู ุญุงูุฉ `pending`

---

### โ ูุซุงู 3: ุญุฐู ูุฑููุถ (ุตูุงุญูุฉ ุฎุงุทุฆุฉ)
**ุงูุณููุงุฑูู:**
- ุทูุจ ููู: `TRF-003`
- ุงูุญุงูุฉ: `pending`
- ุงููุณุชุฎุฏู: `Store Manager`

**ุงููุชูุฌุฉ:**
- โ ูุง ูุธูุฑ ุฒุฑ "ุญุฐู"
- โน๏ธ ุงูุณุจุจ: `Store Manager` ููุณ ูุฏูู ุตูุงุญูุฉ ุงูุญุฐู

---

## ๐ ุณูุฑ ุงูุนูู

```
ุงููุณุชุฎุฏู ููุชุญ ุตูุญุฉ ุชูุงุตูู ุทูุจ ุงูููู
    โ
ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูุงูุญุงูุฉ
    โ
ุฅุฐุง ูุงู (Owner/Admin/Manager) AND (status = pending)
    โ
ูุธูุฑ ุฒุฑ "ุญุฐู"
    โ
ุงููุณุชุฎุฏู ูุถุบุท ุนูู "ุญุฐู"
    โ
ุฑุณุงูุฉ ุชุฃููุฏ
    โ
ุฅุฐุง ูุงูู ุงููุณุชุฎุฏู
    โ
ุฅุฑุณุงู ุทูุจ ุฅูู /api/delete-transfers
    โ
ุญุฐู ุทูุจ ุงูููู ูุจููุฏู
    โ
ุฑุณุงูุฉ ูุฌุงุญ
    โ
ุฅุนุงุฏุฉ ุงูุชูุฌูู ุฅูู /inventory-transfers
```

---

## ๐ฏ ุงูููุงุฆุฏ

1. โ **ุชุตุญูุญ ุงูุฃุฎุทุงุก:** ูููู ุญุฐู ุงูุทูุจุงุช ุงูุฎุงุทุฆุฉ ูุจู ุจุฏุก ุงูููู
2. โ **ุงูุญูุงุธ ุนูู ุณูุงูุฉ ุงููุฎุฒูู:** ูุง ูููู ุญุฐู ุทูุจุงุช ุจุฏุฃุช ุฃู ุงูุชููุช
3. โ **ุชูููุฏ ุงูุตูุงุญูุงุช:** ููุท ุงููุณุชุฎุฏููู ุงููุตุฑุญ ููู ูููููู ุงูุญุฐู
4. โ **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู:** ูุงุฌูุฉ ูุงุถุญุฉ ูุน ุฑุณุงุฆู ุชุฃููุฏ

---

**ุชุงุฑูุฎ ุงูุฅุถุงูุฉ:** 2026-01-03

