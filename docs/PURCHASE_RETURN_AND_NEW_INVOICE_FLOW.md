# ุชุฏูู ูุฑุชุฌุน ุงููุดุชุฑูุงุช ูุงูููุงุชูุฑ ุงูุฌุฏูุฏุฉ

> โ๏ธ **ุชูุจูู ููู:** ูุฐุง ุงููุณุชูุฏ ูุญุชูู ุนูู ูุนูููุงุช ูุฏ ุชุญุชุงุฌ ุชุตุญูุญ. ุฑุงุฌุน `PURCHASE_RETURN_ERP_CORRECTIONS.md` ููุชุตุญูุญุงุช ุงููุญุงุณุจูุฉ ุงูุญุฑุฌุฉ.

## ๐ ุงูุณููุงุฑูู ุงููุทููุจ

**ุงูุณุคุงู:** ูุงุฐุง ูุญุฏุซ ูู ุญุงูุฉ:
1. ุนูู ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงูู ูู ูุงุชูุฑุฉ ูุดุชุฑูุงุช ูุฏููุนุฉ
2. ุนูู ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูููุณ ุงูููุฑุฏ
3. ุฏูุน ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ
4. ูู ูููู ูููุฑุชุฌุน ุนูุงูุฉ ุจูููุฉ ุงููุงุชูุฑุฉ ุงูุซุงููุฉ?

---

## โ ุงูุฅุฌุงุจุฉ ุงูุดุงููุฉ (ููุฏ ุงููุฑุงุฌุนุฉ)

### 1๏ธโฃ ุนูุฏ ุนูู ูุฑุชุฌุน ุนูู ูุงุชูุฑุฉ ูุดุชุฑูุงุช ูุฏููุนุฉ

#### ุฃ) ุฅุฐุง ูุงูุช ุงููุงุชูุฑุฉ **Paid** (ูุฏููุนุฉ ุจุงููุงูู) ุฃู **Partially Paid** (ูุฏููุนุฉ ุฌุฒุฆูุงู):

**ูุง ูุญุฏุซ:**

1. **ุฅูุดุงุก Vendor Credit ุชููุงุฆูุงู** โ
   - ูุชู ุฅูุดุงุก ุฅุดุนุงุฑ ุฏุงุฆู (Vendor Credit) ุชููุงุฆูุงู ุจูููุฉ ุงููุฑุชุฌุน
   - ุฑูู ุงูุฅุดุนุงุฑ: `VC-{ุฑูู ุงููุฑุชุฌุน}`
   - ุงูุญุงูุฉ ุงูุฃูููุฉ: `open` (ููุชูุญ)
   - ุงููุจูุบ ุงููุทุจู: `0` (ูู ููุทุจู ุจุนุฏ)

2. **ุชุญุฏูุซ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ:**
   > โ๏ธ **ุชุตุญูุญ ูุญุงุณุจู:** ุงููุงุชูุฑุฉ ุงููุฏููุนุฉ ูุง ูุฌุจ ุชุนุฏูููุง (audit-locked). ุฑุงุฌุน `PURCHASE_RETURN_ERP_CORRECTIONS.md`
   
   ```
   ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ: 1000 ุฌููู
   ุงููุฏููุน: 1000 ุฌููู
   ุงููุฑุชุฌุน: 300 ุฌููู
   โโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ ุงูุณููู ุงูุตุญูุญ ERP-grade:
   ุงูุฅุฌูุงูู: 1000 ุฌููู (ูุง ูุชุบูุฑ - ูุซููุฉ ุชุงุฑูุฎูุฉ)
   ุงููุฏููุน: 1000 ุฌููู (ูุง ูุชุบูุฑ)
   ุงูุญุงูุฉ: paid (ูุง ุชุชุบูุฑ)
   returned_amount: 300 ุฌููู (ููุท ูููุฑุฌุนูุฉ)
   ```

3. **ุงูููุฏ ุงููุญุงุณุจู:**
   > โ๏ธ **ุชุตุญูุญ ูุญุงุณุจู:** ุงูููุฏ ูุนุชูุฏ ุนูู ุทุฑููุฉ ุงููุฑุชุฌุน. ุฑุงุฌุน `PURCHASE_RETURN_ERP_CORRECTIONS.md`
   
   **ุงูุญุงูุฉ A: Credit Return (Vendor Credit):**
   - **ูุฏูู:** Vendor Credit Liability (AP Contra) - 300
   - **ุฏุงุฆู:** ุงููุฎุฒูู (ูู FIFO) - 300
   
   **ุงูุญุงูุฉ B: Cash Refund:**
   - **ูุฏูู:** ุงูููุฏ/ุงูุจูู - 300
   - **ุฏุงุฆู:** ุงููุฎุฒูู (ูู FIFO) - 300

4. **ุชุญุฏูุซ ุงููุฎุฒูู:**
   - ุฎุตู ุงููููุงุช ุงููุฑุชุฌุนุฉ ูู ุงููุฎุฒูู
   - ุฅูุดุงุก ุญุฑูุฉ ูุฎุฒูู ูู ููุน `purchase_return`

#### ุจ) ุฅุฐุง ูุงูุช ุงููุงุชูุฑุฉ **Received** (ูุณุชููุฉ) ุฃู **Draft** (ูุณูุฏุฉ):

**ูุง ูุญุฏุซ:**
- โ **ูุง ูุชู ุฅูุดุงุก Vendor Credit**
- โ ูุชู ุชุญุฏูุซ ุงููุงุชูุฑุฉ ููุท (ุชูููู ุงูุฅุฌูุงูู)
- โ ูุชู ุฎุตู ุงููุฎุฒูู
- โ ูุง ูุชู ุฅูุดุงุก ููุฏ ูุญุงุณุจู (ูุฃู ุงููุงุชูุฑุฉ ุบูุฑ ูุฏููุนุฉ)

---

### 2๏ธโฃ ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูููุณ ุงูููุฑุฏ

**ูุง ูุญุฏุซ:**

1. **ุฅูุดุงุก ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ:**
   - ูุงุชูุฑุฉ ูุณุชููุฉ ุชูุงูุงู ุนู ุงููุงุชูุฑุฉ ุงูุฃููู
   - ูุง ููุฌุฏ ุฑุจุท ุชููุงุฆู ูุน ุงููุฑุชุฌุน
   - ูุง ูุชู ุฎุตู ุฃู ูุจูุบ ูู ุงููุฑุชุฌุน ุชููุงุฆูุงู

2. **ุญุณุงุจ ุงูุฐูู ุงูุฏุงุฆูุฉ:**
   ```
   ุงูุฐูู ุงูุฏุงุฆูุฉ = ูุฌููุน (ุฅุฌูุงูู ุงููุงุชูุฑุฉ - ุงููุฏููุน) ูุฌููุน ููุงุชูุฑ ุงูููุฑุฏ
   
   ูุซุงู:
   - ุงููุงุชูุฑุฉ ุงูุฃููู (ุจุนุฏ ุงููุฑุชุฌุน): 700 ุฌููู (ูุฏููุนุฉ ุจุงููุงูู)
   - ุงููุงุชูุฑุฉ ุงูุซุงููุฉ: 500 ุฌููู (ุบูุฑ ูุฏููุนุฉ)
   โโโโโโโโโโโโโโโโโโโโโโโโโโ
   ุงูุฐูู ุงูุฏุงุฆูุฉ = 0 + 500 = 500 ุฌููู
   ```

3. **Vendor Credit (ุฅุดุนุงุฑ ุงูุฏุงุฆู):**
   - ูุจูู ูู ุญุงูุฉ `open` (ููุชูุญ)
   - ูููู ุชุทุจููู ูุฏููุงู ุนูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ ุฃู ุฃู ูุงุชูุฑุฉ ุฃุฎุฑู ููููุฑุฏ

---

### 3๏ธโฃ ุนูุฏ ุฏูุน ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ

**ูุง ูุญุฏุซ:**

#### ุฃ) ุจุฏูู ุชุทุจูู Vendor Credit:

1. **ุชุณุฌูู ุงูุฏูุนุฉ:**
   ```
   ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ: 500 ุฌููู
   ุงูุฏูุนุฉ: 500 ุฌููู
   โโโโโโโโโโโโโโโโโโโโโโโโโโ
   ุงููุฏููุน: 500 ุฌููู
   ุงูุญุงูุฉ: paid
   ```

2. **ุงูููุฏ ุงููุญุงุณุจู:**
   - **ูุฏูู:** ุงูุฐูู ุงูุฏุงุฆูุฉ (AP) - ุชูููู ุงูุฏูู
   - **ุฏุงุฆู:** ุงูููุฏ/ุงูุจูู - ุฎุฑูุฌ ุงููุงู

3. **Vendor Credit:**
   - ูุจูู ูู ุญุงูุฉ `open` (ููุชูุญ)
   - ูููู ุชุทุจููู ูุงุญูุงู ุนูู ููุงุชูุฑ ุฃุฎุฑู

#### ุจ) ูุน ุชุทุจูู Vendor Credit (ูุฏููุงู):

1. **ุชุทุจูู Vendor Credit ุนูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ:**
   ```
   ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ: 500 ุฌููู
   Vendor Credit ุงููุชุงุญ: 300 ุฌููู (ูู ุงููุฑุชุฌุน)
   โโโโโโโโโโโโโโโโโโโโโโโโโโ
   ุงููุจูุบ ุงููุทุจู ูู Vendor Credit: 300 ุฌููู
   ุงููุจูุบ ุงููุชุจูู ุนูู ุงููุงุชูุฑุฉ: 200 ุฌููู
   ```

2. **ุฅุฐุง ุฏูุนุช 200 ุฌููู ููุท:**
   ```
   ุงููุฏููุน: 200 ุฌููู
   Vendor Credit ุงููุทุจู: 300 ุฌููู
   โโโโโโโโโโโโโโโโโโโโโโโโโโ
   ุงูุฅุฌูุงูู: 500 ุฌููู (ูุฏููุนุฉ ุจุงููุงูู)
   ```

3. **ุงูููุฏ ุงููุญุงุณุจู:**
   - **ูุฏูู:** ุงูุฐูู ุงูุฏุงุฆูุฉ (AP) - 300 ุฌููู (ูู Vendor Credit)
   - **ุฏุงุฆู:** Vendor Credit Liability - 300 ุฌููู
   - **ูุฏูู:** ุงูุฐูู ุงูุฏุงุฆูุฉ (AP) - 200 ุฌููู (ูู ุงูุฏูุนุฉ ุงูููุฏูุฉ)
   - **ุฏุงุฆู:** ุงูููุฏ/ุงูุจูู - 200 ุฌููู

4. **ุชุญุฏูุซ Vendor Credit:**
   - ุงููุจูุบ ุงููุทุจู: 300 ุฌููู
   - ุงูุญุงูุฉ: `applied` (ุฅุฐุง ุทูุจู ูุงูู ุงููุจูุบ) ุฃู `partially_applied` (ุฅุฐุง ุทูุจู ุฌุฒุก)

---

## ๐ ุงูุนูุงูุฉ ุจูู ุงููุฑุชุฌุน ูุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ

### โ **ูุง ููุฌุฏ ุฑุจุท ุชููุงุฆู**

- ุงููุฑุชุฌุน ูุง ููุทุจู ุชููุงุฆูุงู ุนูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ
- ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ ูุง ุชุนุฑู ุจูุฌูุฏ ุงููุฑุชุฌุน
- ูุฌุจ ุชุทุจูู Vendor Credit ูุฏููุงู ุฅุฐุง ุฃุฑุฏุช ุงุณุชุฎุฏุงูู

### โ **ุงูุฑุจุท ุงููุฏูู (ุงุฎุชูุงุฑู)**

ููููู ุชุทุจูู Vendor Credit ูู ุงููุฑุชุฌุน ุนูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ ูู ุฎูุงู:

1. **ุตูุญุฉ Vendor Credit:**
   - ุงุฐูุจ ุฅูู ุตูุญุฉ ุฅุดุนุงุฑ ุงูุฏุงุฆู
   - ุงุถุบุท "ุชุทุจูู ุนูู ูุงุชูุฑุฉ"
   - ุงุฎุชุฑ ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ
   - ุญุฏุฏ ุงููุจูุบ ุงููุทููุจ ุชุทุจููู

2. **ุตูุญุฉ ุงููุงุชูุฑุฉ:**
   - ูููู ุฑุจุท Vendor Credit ุนูุฏ ุงูุฏูุน (ุฅุฐุง ูุงู ูุชุงุญุงู)

---

## ๐ ูุซุงู ุนููู ุดุงูู

### ุงูุณููุงุฑูู:

1. **ูุงุชูุฑุฉ ูุดุชุฑูุงุช #1:**
   - ุงูุฅุฌูุงูู: 1000 ุฌููู
   - ุงููุฏููุน: 1000 ุฌููู
   - ุงูุญุงูุฉ: `paid`

2. **ูุฑุชุฌุน ุฌุฒุฆู:**
   - ูุจูุบ ุงููุฑุชุฌุน: 300 ุฌููู
   - **ุงููุชูุฌุฉ:**
     - ุงููุงุชูุฑุฉ #1: ุงูุฅุฌูุงูู = 700 ุฌูููุ ุงููุฏููุน = 700 ุฌููู
     - Vendor Credit: 300 ุฌููู (ุญุงูุฉ: `open`)

3. **ูุงุชูุฑุฉ ูุดุชุฑูุงุช #2 (ููุณ ุงูููุฑุฏ):**
   - ุงูุฅุฌูุงูู: 500 ุฌููู
   - ุงููุฏููุน: 0 ุฌููู
   - ุงูุญุงูุฉ: `sent`

4. **ุฏูุน ุงููุงุชูุฑุฉ #2 ุจุฏูู ุชุทุจูู Vendor Credit:**
   - ุงูุฏูุนุฉ: 500 ุฌููู
   - **ุงููุชูุฌุฉ:**
     - ุงููุงุชูุฑุฉ #2: ุงููุฏููุน = 500 ุฌูููุ ุงูุญุงูุฉ = `paid`
     - Vendor Credit: ูุง ูุฒุงู 300 ุฌููู (ุญุงูุฉ: `open`)
     - ุงูุฐูู ุงูุฏุงุฆูุฉ: 0 ุฌููู (ุฌููุน ุงูููุงุชูุฑ ูุฏููุนุฉ)

5. **ุฏูุน ุงููุงุชูุฑุฉ #2 ูุน ุชุทุจูู Vendor Credit:**
   - ุชุทุจูู Vendor Credit: 300 ุฌููู
   - ุงูุฏูุนุฉ ุงูููุฏูุฉ: 200 ุฌููู
   - **ุงููุชูุฌุฉ:**
     - ุงููุงุชูุฑุฉ #2: ุงููุฏููุน = 500 ุฌููู (300 ูู Vendor Credit + 200 ููุฏู)
     - Vendor Credit: ุงููุทุจู = 300 ุฌูููุ ุงูุญุงูุฉ = `applied`
     - ุงูุฐูู ุงูุฏุงุฆูุฉ: 0 ุฌููู

---

## ๐ฏ ุงูุฎูุงุตุฉ

### โ **ูุง ูุญุฏุซ ุชููุงุฆูุงู:**

1. ุนูุฏ ูุฑุชุฌุน ูุงุชูุฑุฉ ูุฏููุนุฉ:
   - โ ุฅูุดุงุก Vendor Credit ุชููุงุฆูุงู
   - โ ุชุญุฏูุซ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ
   - โ ุฅูุดุงุก ุงูููุฏ ุงููุญุงุณุจู
   - โ ุชุญุฏูุซ ุงููุฎุฒูู

2. ุนูุฏ ุฏูุน ูุงุชูุฑุฉ ุฌุฏูุฏุฉ:
   - โ ุชุณุฌูู ุงูุฏูุนุฉ
   - โ ุฅูุดุงุก ุงูููุฏ ุงููุญุงุณุจู
   - โ ุชุญุฏูุซ ุญุงูุฉ ุงููุงุชูุฑุฉ

### โ **ูุง ูุง ูุญุฏุซ ุชููุงุฆูุงู:**

1. โ ุชุทุจูู Vendor Credit ุนูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ (ูุฌุจ ุชุทุจููู ูุฏููุงู)
2. โ ุฑุจุท ุงููุฑุชุฌุน ุจุงููุงุชูุฑุฉ ุงูุฌุฏูุฏุฉ (ูู ูุงุชูุฑุฉ ูุณุชููุฉ)

### ๐ **ุงูุชูุตูุฉ:**

- ุงุณุชุฎุฏู Vendor Credit ูุชูููู ุงููุฏููุนุงุช ุงูููุฏูุฉ
- ุฑุงุฌุน Vendor Credits ุงูููุชูุญุฉ ูุจู ุฏูุน ููุงุชูุฑ ุฌุฏูุฏุฉ
- ุทุจู Vendor Credits ุนูู ุงูููุงุชูุฑ ุงูุฌุฏูุฏุฉ ูุชูููู ุงูุชุฏูู ุงูููุฏู

---

## ๐ ุงููููุงุช ุงููุฑุฌุนูุฉ

- `lib/purchase-returns-vendor-credits.ts` - ููุทู ุฅูุดุงุก Vendor Credits
- `app/purchase-returns/new/page.tsx` - ูุนุงูุฌุฉ ูุฑุชุฌุนุงุช ุงููุดุชุฑูุงุช
- `app/vendor-credits/[id]/page.tsx` - ุชุทุจูู Vendor Credits
- `app/payments/page.tsx` - ูุนุงูุฌุฉ ุงูุฏูุนุงุช
- `docs/VENDOR_CREDITS_AUTOMATIC_SYSTEM.md` - ุชูุซูู ุงููุธุงู

---

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2026-01-15  
**ุขุฎุฑ ุชุญุฏูุซ:** 2026-01-15
