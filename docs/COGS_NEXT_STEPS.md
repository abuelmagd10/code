# ุงูุฎุทูุงุช ุงูุชุงููุฉ ููุธุงู COGS Professional

## โ ุงูุญุงูุฉ ุงูุญุงููุฉ

### ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู:
- โ ุฌุฏูู `cogs_transactions` ููุฌูุฏ ูุณููู
- โ FIFO Lots ูุชุงุญุฉ ููุงุฎุชุจุงุฑ
- โ ุชูุฌุฏ ููุงุชูุฑ Sent ุฌุงูุฒุฉ (ูุงุฎุชุจุงุฑ ุงููุฑุชุฌุนุงุช)
- โ ุงูุญูููุฉ ุณูููุฉ

### ุงููุชุงุฆุฌ ุงูุญุงููุฉ:
- โน๏ธ ูุง ุชูุฌุฏ ููุงุชูุฑ ุฌุฏูุฏุฉ ุชู ุฅุฑุณุงููุง ุจุนุฏ ุงูุชุญุฏูุซ (ุทุจูุนู)
- โน๏ธ ุงูููุงุชูุฑ ุงููุฏููุฉ ุจุฏูู COGS transactions (ุทุจูุนู - ุชู ุฅูุดุงุคูุง ูุจู ุงูุชุญุฏูุซ)

---

## ๐ฏ ุฎูุงุฑุงุช ุงููุชุงุจุนุฉ

### ุงูุฎูุงุฑ 1: ุงุฎุชุจุงุฑ ุงููุธุงู ุงููุนูู (ููุตู ุจู ุฃููุงู)

**ููุชุญูู ูู ุฃู ุงููุธุงู ูุนูู**:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ (Draft)
2. ุฅุถุงูุฉ ููุชุฌุงุช (ูุฏููุง FIFO Lots)
3. ุงูุชุฃูุฏ ูู `branch_id`, `cost_center_id`, `warehouse_id`
4. ุชุบููุฑ ุญุงูุฉ Invoice ุฅูู `sent`
5. ุงูุชุญูู ูู ุฅูุดุงุก COGS Transactions

**ุงูุชุญูู**:
```sql
-- ุจุนุฏ ุฅุฑุณุงู ุงููุงุชูุฑุฉุ ุชุญูู ูู:
SELECT 
  ct.*,
  p.name as product_name,
  i.invoice_number
FROM cogs_transactions ct
JOIN products p ON ct.product_id = p.id
JOIN invoices i ON ct.source_id = i.id
WHERE ct.source_type = 'invoice'
  AND ct.created_at >= CURRENT_DATE
ORDER BY ct.created_at DESC;
```

---

### ุงูุฎูุงุฑ 2: ุงูุงูุชูุงู ูุจุงุดุฑุฉ ุฅูู Inventory Depreciation

**ุฅุฐุง ููุช ูุชุฃูุฏุงู ูู ุฃู ุงููุธุงู ูุนูู** (ุฃู ุชุฑูุฏ ุชุทููุฑ Depreciation ุงูุขู):

**ุงููุชุทูุจุงุช**:
1. โ ูุธุงู COGS Professional ุฌุงูุฒ (ุชู)
2. ๐ Inventory Depreciation ูุน:
   - ุงุณุชููุงู FIFO Lots
   - ุฅูุดุงุก COGS transactions (`source_type = 'depreciation'`)
   - ุงูุญูููุฉ ุงูุฅูุฒุงููุฉ
   - ููุน ุงูุฅููุงู ุฅุฐุง ุงูุฑุตูุฏ ุบูุฑ ูุงูู

---

## ๐ ูุง ุณูุชู ูู Inventory Depreciation

### ุงูููุฒุงุช ุงููุทููุจุฉ:

1. **ุงุณุชููุงู FIFO Lots**:
   - ุงูุฅููุงู ูุณุชููู FIFO Lots ุจุชุฑุชูุจ FIFO
   - ููุณ ููุทู Invoice Sent

2. **ุฅูุดุงุก COGS Transactions**:
   - `source_type = 'depreciation'`
   - ููุณ ุงูุญูููุฉ: `branch_id`, `cost_center_id`, `warehouse_id`
   - `unit_cost` ูู FIFO Engine ููุท

3. **ุงูุชุญูู ูู ุงูุฑุตูุฏ**:
   - ููุน ุงูุฅููุงู ุฅุฐุง ุงูุฑุตูุฏ ุงููุนูู ุบูุฑ ูุงูู
   - ุงูุชุญูู ุนูู ูุณุชูู ุงููุฑุน/ุงููุฎุฒู

4. **ุงูุชูุงูู ูุน ุงููุธุงู**:
   - ุงุณุชุฎุฏุงู `consumeFIFOLotsWithCOGS()` ูุน `sourceType = 'depreciation'`
   - ููุณ RLS Policies ูุงูุญูููุฉ

---

## โ ุงููุฑุงุฑ

**ูู ููุชูู ูุจุงุดุฑุฉ ุฅูู Inventory Depreciationุ**

ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ **ูุนู**ุ ุณุฃุจุฏุฃ ุจุฅูุดุงุก:
1. SQL migration ููุฅููุงู (ุฅุฐุง ูุฒู)
2. API endpoint ููุฅููุงู
3. Integration ูุน FIFO Engine + COGS Transactions
4. Validation functions

ุฅุฐุง ูุงูุช ุงูุฅุฌุงุจุฉ **ูุง**ุ ุณููุชุธุฑ ุญุชู:
1. ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ ูุฅุฑุณุงููุง
2. ุงูุชุญูู ูู ุฅูุดุงุก COGS Transactions
3. ุงุฎุชุจุงุฑ Sales Return โ COGS Reversal

---

## ๐ ููุงุญุธุฉ

**ุงููุธุงู ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูุขู**. ููููู:
- ุฅูุดุงุก ูุงุชูุฑุฉ ุฌุฏูุฏุฉ โ ุณุชูุดุฆ COGS transactions ุชููุงุฆูุงู
- ุฅูุดุงุก ูุฑุชุฌุน โ ุณูุนูุณ COGS ุชููุงุฆูุงู
- ุนุฑุถ Dashboard Stats โ ุณูุณุชุฎุฏู `cogs_transactions` ููููุงุชูุฑ ุงูุฌุฏูุฏุฉ

**Inventory Depreciation** ูู ุงูููุฒุฉ ุงูุชุงููุฉ ุงููุทููุจุฉุ ููููู ุชุทููุฑู ุงูุขู ุฅุฐุง ููุช ูุชุฃูุฏุงู ูู ุงููุธุงู.
