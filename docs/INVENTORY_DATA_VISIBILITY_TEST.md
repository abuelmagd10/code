# ๐ ุฏููู ุงุฎุชุจุงุฑ ุตูุงุญูุฉ ุงูุจูุงูุงุช ูู ุตูุญุฉ ุงููุฎุฒูู

## ๐ ูุธุฑุฉ ุนุงูุฉ
ูุฐุง ุงูุฏููู ููุถุญ ููููุฉ ุงูุชุญูู ูู ุฃู ุตูุญุฉ ุงููุฎุฒูู (`/inventory`) ุชุทุจู ููุงุนุฏ ุฑุคูุฉ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ ูู **"ุดุฑูุฉ ุชุณุช"** ุจุฌููุน ูุฑูุนูุง.

---

## ๐ฏ ุฃูุฏุงู ุงูุงุฎุชุจุงุฑ

1. โ ุงูุชุญูู ูู ุฃู ุงููุณุชุฎุฏููู ูุฑูู ุงูุจูุงูุงุช ุงูุตุญูุญุฉ ุญุณุจ ุฃุฏูุงุฑูู
2. โ ุงูุชุญูู ูู ุฃู Admin/General Manager ูุฑู ุฌููุน ุงููุฑูุน
3. โ ุงูุชุญูู ูู ุฃู Manager/Accountant ูุฑู ููุท ูุฑุนู
4. โ ุงูุชุญูู ูู ุฃู Staff ูุฑู ููุท ุญุฑูุงุช ูุฑุนู/ูุฎุฒูู
5. โ ุงูุชุญูู ูู ุฃู ุญุฑูุงุช `transfer_in/transfer_out` ุชูุนุฑุถ ุจุดูู ุตุญูุญ

---

## ๐ฅ ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ

### 1๏ธโฃ ุงุฎุชุจุงุฑ Admin/General Manager

**ุงูุฎุทูุงุช:**
1. ุณุฌู ุงูุฏุฎูู ูู Admin/General Manager
2. ุงุฎุชุฑ "ุดุฑูุฉ ุชุณุช" ูู ุงููุงุฆูุฉ
3. ุงูุชูู ุฅูู `/inventory`
4. ุชุญูู ูู:
   - โ ููููู ุงุฎุชูุงุฑ **ุฌููุน** ุงููุฑูุน ูู selector ุงููุฑุน
   - โ ุนูุฏ ุงุฎุชูุงุฑ ูู ูุฑุนุ ููููู ุฑุคูุฉ ุฌููุน ูุฎุงุฒูู
   - โ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุตุญูุญุฉ ููู ูุฑุน/ูุฎุฒู
   - โ ููููู ุฑุคูุฉ ุฌููุน ุญุฑูุงุช ุงููุฎุฒูู ูู ุฌููุน ุงููุฑูุน

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ Admin ูุฑู **ุฌููุน** ุงููุฑูุน ูุงููุฎุงุฒู
- โ ูุง ุชูุฌุฏ ูููุฏ ุนูู ุฑุคูุฉ ุงูุจูุงูุงุช

---

### 2๏ธโฃ ุงุฎุชุจุงุฑ Manager/Accountant

**ุงูุฎุทูุงุช:**
1. ุณุฌู ุงูุฏุฎูู ูู Manager ุฃู Accountant ูู ูุฑุน ูุนูู (ูุซูุงู: "ูุฑุน ุงููุงูุฑุฉ")
2. ุงุฎุชุฑ "ุดุฑูุฉ ุชุณุช" ูู ุงููุงุฆูุฉ
3. ุงูุชูู ุฅูู `/inventory`
4. ุชุญูู ูู:
   - โ selector ุงููุฑุน **ุบูุฑ ูุงุจู ููุชุนุฏูู** (ูุธูุฑ ูุฑุนู ููุท)
   - โ ููููู ุงุฎุชูุงุฑ ูุฎุงุฒู ูุฑุนู ููุท
   - โ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุฎุงุตุฉ ุจูุฑุนู ููุท
   - โ ูุง ููููู ุฑุคูุฉ ุจูุงูุงุช ูุฑูุน ุฃุฎุฑู

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ Manager/Accountant ูุฑู **ููุท** ูุฑุนู
- โ ููููู ุฑุคูุฉ ุฌููุน ูุฎุงุฒู ูุฑุนู
- โ ููููู ุฑุคูุฉ ุฌููุน ุญุฑูุงุช ุงููุฎุฒูู ูู ูุฑุนู (ุจุบุถ ุงููุธุฑ ุนู ููุดุฆูุง)

---

### 3๏ธโฃ ุงุฎุชุจุงุฑ Staff

**ุงูุฎุทูุงุช:**
1. ุณุฌู ุงูุฏุฎูู ูู Staff ูู ูุฑุน ููุฑูุฒ ุชูููุฉ ููุฎุฒู ูุนูู
2. ุงุฎุชุฑ "ุดุฑูุฉ ุชุณุช" ูู ุงููุงุฆูุฉ
3. ุงูุชูู ุฅูู `/inventory`
4. ุชุญูู ูู:
   - โ selector ุงููุฑุน **ุบูุฑ ูุงุจู ููุชุนุฏูู** (ูุธูุฑ ูุฑุนู ููุท)
   - โ selector ุงููุฎุฒู **ุบูุฑ ูุงุจู ููุชุนุฏูู** (ูุธูุฑ ูุฎุฒูู ููุท)
   - โ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุฎุงุตุฉ ุจูุฑุนู/ูุฎุฒูู ููุท
   - โ ููููู ุฑุคูุฉ ุฌููุน ุญุฑูุงุช ุงููุฎุฒูู ูู ูุฑุนู/ูุฎุฒูู (ุจุบุถ ุงููุธุฑ ุนู ููุดุฆูุง)

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ Staff ูุฑู **ููุท** ูุฑุนู/ูุฎุฒูู
- โ ููููู ุฑุคูุฉ ุฌููุน ุญุฑูุงุช ุงููุฎุฒูู ูู ูุฑุนู/ูุฎุฒูู (ุญุชู ูู ูู ููุดุฆูุง)

---

## ๐ ุงูุชุญูู ูู ุงูุจูุงูุงุช

### 1. ุงูุชุญูู ูู ุญุฑูุงุช ุงููุฎุฒูู

**ุงูุฎุทูุงุช:**
1. ุงูุชุญ ุตูุญุฉ ุงููุฎุฒูู
2. ุงูุชูู ุฅูู ูุณู "ุญุฑูุงุช ุงููุฎุฒูู" (Inventory Movements)
3. ุชุญูู ูู:
   - โ ุฌููุน ุงูุญุฑูุงุช ุงููุนุฑูุถุฉ ุชูุชูู ููุดุฑูุฉ ุงูุตุญูุญุฉ
   - โ ุฌููุน ุงูุญุฑูุงุช ุงููุนุฑูุถุฉ ุชูุชูู ูููุฑุน ุงูุตุญูุญ (ุญุณุจ ุฏูุฑ ุงููุณุชุฎุฏู)
   - โ ุฌููุน ุงูุญุฑูุงุช ุงููุนุฑูุถุฉ ุชูุชูู ูููุฎุฒู ุงููุญุฏุฏ
   - โ ุญุฑูุงุช `transfer_in/transfer_out` ุชูุนุฑุถ ุจุดูู ุตุญูุญ

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ ุงูุจูุงูุงุช ุงููููุชุฑุฉ ุตุญูุญุฉ ุญุณุจ ููุงุนุฏ ุฑุคูุฉ ุงูุจูุงูุงุช

---

### 2. ุงูุชุญูู ูู ุฌุฏูู ุญุงูุฉ ุงููุฎุฒูู

**ุงูุฎุทูุงุช:**
1. ุงูุชุญ ุตูุญุฉ ุงููุฎุฒูู
2. ุงูุชูู ุฅูู ุฌุฏูู "ุญุงูุฉ ุงููุฎุฒูู" (Inventory Status)
3. ุชุญูู ูู:
   - โ ุฌููุน ุงูููุชุฌุงุช ุงููุนุฑูุถุฉ ููุง ุญุฑูุงุช ูู ุงููุฎุฒู ุงููุญุฏุฏ
   - โ ุงููููุงุช ุงููุญุณูุจุฉ ุตุญูุญุฉ
   - โ ุงูุฅุญุตุงุฆูุงุช (ุงููุดุชุฑูุงุชุ ุงููุจูุนุงุชุ ุงููุฑุชุฌุนุงุช) ุตุญูุญุฉ

**ุงููุชูุฌุฉ ุงููุชููุนุฉ:**
- โ ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุตุญูุญุฉ ููุชุณูุฉ

---

## ๐งช ุงุฎุชุจุงุฑ SQL ููุชุญูู ูู ุงูุจูุงูุงุช

ููููู ุงุณุชุฎุฏุงู ูุฐุง ุงูุงุณุชุนูุงู ููุชุญูู ูู ุงูุจูุงูุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

```sql
-- 1. ุงูุชุญูู ูู ุญุฑูุงุช ุงููุฎุฒูู ูู "ุดุฑูุฉ ุชุณุช"
SELECT 
  it.id,
  it.transaction_type,
  it.quantity_change,
  it.branch_id,
  b.name AS branch_name,
  it.warehouse_id,
  w.name AS warehouse_name,
  it.cost_center_id,
  cc.name AS cost_center_name,
  it.company_id,
  c.name AS company_name
FROM inventory_transactions it
LEFT JOIN branches b ON it.branch_id = b.id
LEFT JOIN warehouses w ON it.warehouse_id = w.id
LEFT JOIN cost_centers cc ON it.cost_center_id = cc.id
LEFT JOIN companies c ON it.company_id = c.id
WHERE c.name = 'ุดุฑูุฉ ุชุณุช' OR c.name LIKE '%ุชุณุช%'
ORDER BY it.created_at DESC
LIMIT 50;

-- 2. ุงูุชุญูู ูู ุงููุฑูุน ูู "ุดุฑูุฉ ุชุณุช"
SELECT 
  b.id,
  b.name,
  b.branch_name,
  b.company_id,
  c.name AS company_name
FROM branches b
LEFT JOIN companies c ON b.company_id = c.id
WHERE c.name = 'ุดุฑูุฉ ุชุณุช' OR c.name LIKE '%ุชุณุช%'
ORDER BY b.name;

-- 3. ุงูุชุญูู ูู ุงููุฎุงุฒู ูู "ุดุฑูุฉ ุชุณุช"
SELECT 
  w.id,
  w.name,
  w.branch_id,
  b.name AS branch_name,
  w.company_id,
  c.name AS company_name
FROM warehouses w
LEFT JOIN branches b ON w.branch_id = b.id
LEFT JOIN companies c ON w.company_id = c.id
WHERE c.name = 'ุดุฑูุฉ ุชุณุช' OR c.name LIKE '%ุชุณุช%'
ORDER BY b.name, w.name;

-- 4. ุงูุชุญูู ูู ุญุฑูุงุช transfer_in/transfer_out
SELECT 
  it.id,
  it.transaction_type,
  it.quantity_change,
  it.branch_id,
  b.name AS branch_name,
  it.warehouse_id,
  w.name AS warehouse_name,
  it.cost_center_id,
  cc.name AS cost_center_name
FROM inventory_transactions it
LEFT JOIN branches b ON it.branch_id = b.id
LEFT JOIN warehouses w ON it.warehouse_id = w.id
LEFT JOIN cost_centers cc ON it.cost_center_id = cc.id
WHERE it.transaction_type IN ('transfer_in', 'transfer_out')
  AND it.company_id IN (
    SELECT id FROM companies 
    WHERE name = 'ุดุฑูุฉ ุชุณุช' OR name LIKE '%ุชุณุช%'
  )
ORDER BY it.created_at DESC;
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ุงูููุงุฆูุฉ

### ููู Admin/General Manager:
- [ ] ูููู ุงุฎุชูุงุฑ ุฌููุน ุงููุฑูุน
- [ ] ูููู ุฑุคูุฉ ุฌููุน ุงููุฎุงุฒู ููู ูุฑุน
- [ ] ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุตุญูุญุฉ ููู ูุฑุน/ูุฎุฒู
- [ ] ูุง ุชูุฌุฏ ูููุฏ ุนูู ุฑุคูุฉ ุงูุจูุงูุงุช

### ููู Manager/Accountant:
- [ ] selector ุงููุฑุน ุบูุฑ ูุงุจู ููุชุนุฏูู (ูุธูุฑ ูุฑุน ุงููุณุชุฎุฏู ููุท)
- [ ] ูููู ุฑุคูุฉ ุฌููุน ูุฎุงุฒู ุงููุฑุน
- [ ] ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุฎุงุตุฉ ุจุงููุฑุน ููุท
- [ ] ูุง ูููู ุฑุคูุฉ ุจูุงูุงุช ูุฑูุน ุฃุฎุฑู

### ููู Staff:
- [ ] selector ุงููุฑุน ุบูุฑ ูุงุจู ููุชุนุฏูู (ูุธูุฑ ูุฑุน ุงููุณุชุฎุฏู ููุท)
- [ ] selector ุงููุฎุฒู ุบูุฑ ูุงุจู ููุชุนุฏูู (ูุธูุฑ ูุฎุฒู ุงููุณุชุฎุฏู ููุท)
- [ ] ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุฎุงุตุฉ ุจุงููุฑุน/ุงููุฎุฒู ููุท
- [ ] ูููู ุฑุคูุฉ ุฌููุน ุญุฑูุงุช ุงููุฎุฒูู ูู ุงููุฑุน/ุงููุฎุฒู (ุจุบุถ ุงููุธุฑ ุนู ููุดุฆูุง)

### ููุฌููุน:
- [ ] ุญุฑูุงุช `transfer_in/transfer_out` ุชูุนุฑุถ ุจุดูู ุตุญูุญ
- [ ] ุงููููุงุช ุงููุญุณูุจุฉ ุตุญูุญุฉ
- [ ] ุงูุฅุญุตุงุฆูุงุช (ุงููุดุชุฑูุงุชุ ุงููุจูุนุงุชุ ุงููุฑุชุฌุนุงุช) ุตุญูุญุฉ
- [ ] ูุง ุชูุฌุฏ ุฃุฎุทุงุก ูู Console

---

## ๐ ุงููุดุงูู ุงููุญุชููุฉ ูุญููููุง

### ุงููุดููุฉ 1: ุงููุณุชุฎุฏู ูุฑู ุจูุงูุงุช ูุฑูุน ุฃุฎุฑู
**ุงูุณุจุจ:** ููุงุนุฏ ุฑุคูุฉ ุงูุจูุงูุงุช ูุง ุชุทุจู ุจุดูู ุตุญูุญ
**ุงูุญู:** ุชุญูู ูู:
- ุฃู `buildDataVisibilityFilter` ููุณุชุฏุนู ุจุดูู ุตุญูุญ
- ุฃู `applyDataVisibilityFilter` ูุทุจู ุงูููุงุชุฑ ุจุดูู ุตุญูุญ
- ุฃู `branch_id` ูู `userContext` ุตุญูุญ

### ุงููุดููุฉ 2: ุญุฑูุงุช `transfer_in/transfer_out` ูุง ุชูุนุฑุถ
**ุงูุณุจุจ:** ุงูููุชุฑุฉ ูู JavaScript ูุฏ ุชููู ุฎุงุทุฆุฉ
**ุงูุญู:** ุชุญูู ูู:
- ุฃู ุงูููุฏ ูู ุงูุณุทูุฑ 274-282 ู 311-319 ูุนูู ุจุดูู ุตุญูุญ
- ุฃู `cost_center_id` ูู ุงูุญุฑูุงุช ุตุญูุญ

### ุงููุดููุฉ 3: ุงูุจูุงูุงุช ุงููุนุฑูุถุฉ ุบูุฑ ุตุญูุญุฉ
**ุงูุณุจุจ:** ูุฏ ุชููู ููุงู ูุดููุฉ ูู ุญุณุงุจ ุงููููุงุช
**ุงูุญู:** ุชุญูู ูู:
- ุฃู `computedQty` ููุญุณุจ ุจุดูู ุตุญูุญ
- ุฃู ุฌููุน ุฃููุงุน ุงูุญุฑูุงุช (purchase, sale, return, etc.) ุชูุญุณุจ ุจุดูู ุตุญูุญ

---

## ๐ ููุงุญุธุงุช

1. **ุงููุฎุฒูู ูุฎุชูู ุนู ุงููุณุชูุฏุงุช ุงูุฃุฎุฑู:**
   - ูู ุงููุฎุฒููุ ุงูููุธู ูุฑู **ุฌููุน** ุญุฑูุงุช ูุฑุนู/ูุฎุฒูู (ูููุณ ููุท ูุง ุฃูุดุฃู)
   - ูุฐุง ูุฎุชูู ุนู Sales Orders ุญูุซ ุงูููุธู ูุฑู ููุท ุทูุจุงุชู

2. **ุญุฑูุงุช transfer_in/transfer_out:**
   - ูุฐู ุงูุญุฑูุงุช ุชูุนุฑุถ ุญุชู ูู ูุงูุช ูู `cost_center_id` ูุฎุชูู
   - ููู ูุฌุจ ุฃู ุชููู ูู ููุณ ุงููุฑุน ูุงููุฎุฒู

3. **ุงูููุชุฑุฉ ูู JavaScript:**
   - ุจุนุถ ุงูููุชุฑุฉ ุชุชู ูู JavaScript (ุฎุงุตุฉ ูู `cost_center_id` ู `transfer_in/transfer_out`)
   - ูุฐุง ูุฃู Supabase query builder ูุง ูุฏุนู ุจุนุถ ุงูุญุงูุงุช ุงููุนูุฏุฉ

---

## ๐ ุฑูุงุจุท ูููุฏุฉ

- [ุตูุญุฉ ุงููุฎุฒูู](/inventory)
- [ูุธุงู ุงูุญูููุฉ ุงูููุญุฏ](/docs/DATA_VISIBILITY_GOVERNANCE.md)
- [ููุงุนุฏ ุฑุคูุฉ ุงูุจูุงูุงุช](/lib/data-visibility-control.ts)

---

**ุขุฎุฑ ุชุญุฏูุซ:** {{ new Date().toLocaleDateString('ar-SA') }}
