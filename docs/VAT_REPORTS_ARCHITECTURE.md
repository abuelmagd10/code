# ๐ ุชูุงุฑูุฑ ุงูุถุฑุงุฆุจ (VAT Reports) - ุงูุชูุซูู ุงููุนูุงุฑู

**ุชุงุฑูุฎ ุงูุงุนุชูุงุฏ:** 2026-01-25  
**ุงูุญุงูุฉ:** โ ูุนุชูุฏ ููุงุฆููุง  
**ุงููุณุชูู:** Architectural Standards

---

## ๐ ููุฎุต

ุชูุงุฑูุฑ ุงูุถุฑุงุฆุจ ุชุนุฑุถ ุถุฑูุจุฉ ุงููุฎุฑุฌุงุช (Output VAT) ูุถุฑูุจุฉ ุงููุฏุฎูุงุช (Input VAT) ูู ุงููููุฏ ุงููุญุงุณุจูุฉ.

**ูุฌุจ ุฃู ูุชุทุงุจู:**
- ุถุฑูุจุฉ ุงููุฎุฑุฌุงุช = ูุฌููุน credit_amount ูู ุญุณุงุจุงุช `vat_output`
- ุถุฑูุจุฉ ุงููุฏุฎูุงุช = ูุฌููุน debit_amount ูู ุญุณุงุจุงุช `vat_input`

---

## ๐น ูุตุฏุฑ ุงูุจูุงูุงุช

### ุงููุตุฏุฑ ุงููุญูุฏ ุงููุณููุญ

```
journal_entries โ journal_entry_lines (vat_output/vat_input) โ vat_reports
```

**ููููุน ููุนูุง ุจุงุชูุง:**
- โ ูุฑุงุกุฉ ูู `invoices.tax_amount` ูุจุงุดุฑุฉ
- โ ูุฑุงุกุฉ ูู `bills.tax_amount` ูุจุงุดุฑุฉ
- โ ุฃู ูุตุฏุฑ ุจูุงูุงุช ุขุฎุฑ

### ุงูุฌุฏุงูู ุงููุณุชุฎุฏูุฉ

1. **`chart_of_accounts`**
   - ููุชุฑุฉ: `sub_type IN ('vat_output', 'vat_payable')` ููู Output
   - ููุชุฑุฉ: `sub_type IN ('vat_input', 'vat_receivable')` ููู Input
   - ุงูุญููู: `id`, `account_code`, `account_name`, `sub_type`

2. **`journal_entries`**
   - ููุชุฑุฉ: `company_id`, `status = 'posted'`, `deleted_at IS NULL`
   - ุงููุชุฑุฉ: `entry_date BETWEEN from_date AND to_date`
   - ุงูููุน: `reference_type = 'invoice'` ููู Outputุ `reference_type = 'bill'` ููู Input

3. **`journal_entry_lines`**
   - ุงูุญููู: `account_id`, `debit_amount`, `credit_amount`
   - ุงูุฑุจุท: `account_id IN (vat_account_ids)`
   - Output: `credit_amount > 0`
   - Input: `debit_amount > 0`

---

## ๐น ุงููุนุงุฏูุงุช ุงููุณุชุฎุฏูุฉ

### ุญุณุงุจ ุถุฑูุจุฉ ุงููุฎุฑุฌุงุช (Output VAT)

```typescript
// VAT Output = ูุฌููุน credit_amount ูู ุญุณุงุจุงุช vat_output
const vatOutput = journal_entry_lines
  .filter(line => vatOutputAccountIds.includes(line.account_id))
  .reduce((sum, line) => sum + line.credit_amount, 0)
```

### ุญุณุงุจ ุถุฑูุจุฉ ุงููุฏุฎูุงุช (Input VAT)

```typescript
// VAT Input = ูุฌููุน debit_amount ูู ุญุณุงุจุงุช vat_input
const vatInput = journal_entry_lines
  .filter(line => vatInputAccountIds.includes(line.account_id))
  .reduce((sum, line) => sum + line.debit_amount, 0)
```

### ุตุงูู ุงูุถุฑูุจุฉ ุงููุณุชุญูุฉ

```typescript
// Net VAT = VAT Output - VAT Input
const netVat = vatOutput - vatInput
```

---

## ๐น ุงูุนูุงูุงุช ูุน ุงูุชูุงุฑูุฑ ุงูุฃุฎุฑู

### ุงูุชูุงูู ูุน ุงูููุฒุงููุฉ ุงูุนููููุฉ

**ูุฌุจ ุฃู ูุชุญูู ุฏุงุฆููุง:**

```
ุฑุตูุฏ ุญุณุงุจ VAT Output ูู ุงูููุฒุงููุฉ = ูุฌููุน ุถุฑูุจุฉ ุงููุฎุฑุฌุงุช ูู ุงูุชูุฑูุฑ
ุฑุตูุฏ ุญุณุงุจ VAT Input ูู ุงูููุฒุงููุฉ = ูุฌููุน ุถุฑูุจุฉ ุงููุฏุฎูุงุช ูู ุงูุชูุฑูุฑ
```

**ุงูุชุญูู:**
- ูุชู ุญุณุงุจ ุงูุถุฑูุจุฉ ูู ููุณ ุงููุตุฏุฑ (`journal_entries`)
- ุฃู ุงุฎุชูุงู = ุฎุทุฃ ูุธุงู

---

## ๐น ุงููููุฏ ุงููุนุชูุฏุฉ

### ุงูููุชุฑุฉ

1. **ุงูุดุฑูุฉ:** `company_id` (ุฅูุฒุงูู)
2. **ุงููุชุฑุฉ:** `entry_date BETWEEN from_date AND to_date`
3. **ุงูุญุงูุฉ:** `status = 'posted'` ู `deleted_at IS NULL`
4. **ููุน ุงููุฑุฌุน:** `reference_type = 'invoice'` ููู Outputุ `reference_type = 'bill'` ููู Input
5. **ุญุงูุฉ ุงููุงุชูุฑุฉ:** (ุงุฎุชูุงุฑู) `paid`, `partially_paid`, `sent`, `all`

### ุญุณุงุจุงุช VAT

- **Output:** `sub_type IN ('vat_output', 'vat_payable')`
- **Input:** `sub_type IN ('vat_input', 'vat_receivable')`

---

## ๐น ุญุงูุงุช ุงูุฎุทุฃ

### 1. ุนุฏู ุชุทุงุจู ูุน ุงูููุฒุงููุฉ

**ุงูุญุงูุฉ:** ุถุฑูุจุฉ ุงููุฎุฑุฌุงุช ูู ุงูุชูุฑูุฑ โ ุฑุตูุฏ ุญุณุงุจ VAT Output ูู ุงูููุฒุงููุฉ

**ุงูุณุจุจ ุงููุญุชูู:**
- ูููุฏ ุบูุฑ ูุชูุงุฒูุฉ
- ูููุฏ ูุญุฐููุฉ
- ุฃุฎุทุงุก ูู ุงูุญุณุงุจ

**ุงูุฅุฌุฑุงุก:**
- ุนุฑุถ ุชุญุฐูุฑ ูุงุถุญ
- ุชุณุฌูู ุงูุฎุทุฃ ูู logs
- ุทูุจ ูุฑุงุฌุนุฉ ุงููููุฏ

---

## ๐ ุงููููุงุช

### APIs
- **VAT Output:** `app/api/vat-output/route.ts`
- **VAT Input:** `app/api/vat-input/route.ts`
- **ุงููุธููุฉ:** ุญุณุงุจ ุงูุถุฑุงุฆุจ ูู `journal_entries`

### Frontend
- **VAT Output:** `app/reports/vat-output/page.tsx`
- **VAT Input:** `app/reports/vat-input/page.tsx`
- **VAT Summary:** `app/reports/vat-summary/page.tsx`

---

## ๐น ุงูุชุญุณููุงุช ุงููุณุชูุจููุฉ

### Realtime Updates

**ุงููุทููุจ:**
- ุงูุงุดุชุฑุงู ูู ุชุญุฏูุซุงุช `journal_entries`
- ุชุญุฏูุซ ุงูุชูุฑูุฑ ูุญุธููุง ุนูุฏ ุฅุฏุฎุงู/ุชุนุฏูู ููุฏ
- ุฅุนุงุฏุฉ ุงูุชุญูู ูู ุงูุชูุงูู ูุน ุงูููุฒุงููุฉ

### ุงูุชุญูู ุงูุชููุงุฆู

**ุงููุทููุจ:**
- ุงูุชุญูู ูู ุงูุชูุงูู ูุน ุงูููุฒุงููุฉ ุชููุงุฆููุง
- ุนุฑุถ ุชุญุฐูุฑ ุนูุฏ ุฃู ุงุฎุชูุงู

---

## โ ูุนุงููุฑ ุงูุฌูุฏุฉ

### ุงูุตุญุฉ ุงููุญุงุณุจูุฉ
- โ ุฌููุน ุงูุฃุฑูุงู ูุงุจูุฉ ููุชุชุจุน ุฅูู `journal_entries`
- โ ุงูุชูุงูู ูุน ุงูููุฒุงููุฉ ูุญูู
- โ ูุง ุชูุฌุฏ ููู ุซุงุจุชุฉ

### ุงูุงุณุชูุฑุงุฑ ุงูุชููู
- โ ูุง ุชุนุชูุฏ ุนูู ุชุฎุฒูู ูุคูุช
- โ ุญุณุงุจ ุฏููุงูููู ูู ูู ูุฑุฉ
- โ ูุนุงูุฌุฉ ุฃุฎุทุงุก ุดุงููุฉ

### ุงููุทุงุจูุฉ ุงููุนูุงุฑูุฉ
- โ ูุทุงุจู ูู Odoo
- โ ูุทุงุจู ูู Zoho Books
- โ ูุทุงุจู ูู SAP
- โ ูุทุงุจู ูููุนุงููุฑ ุงููุญุงุณุจูุฉ ุงูุฏูููุฉ

---

## ๐ ุณุฌู ุงูุชุบููุฑุงุช

| ุงูุชุงุฑูุฎ | ุงูุชุบููุฑ | ุงููุนุชูุฏ |
|---------|---------|---------|
| 2026-01-25 | ุฅูุดุงุก APIs ุฌุฏูุฏุฉ ูู journal_entries | โ |
| 2026-01-25 | ุชุญุฏูุซ Frontend ูุงุณุชุฎุฏุงู APIs ุงูุฌุฏูุฏุฉ | โ |
| 2026-01-25 | ุงุนุชูุงุฏ ููุงุฆู ููููุทู | โ |

---

**ุชู ุงูุงุนุชูุงุฏ ุงูููุงุฆู โ**
