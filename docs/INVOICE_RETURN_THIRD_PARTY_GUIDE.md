# ๐ ุฏููู ุดุงูู: ููุงุชูุฑ ุงูุจูุน ูุงููุฑุชุฌุนุงุช ูุจุถุงุฆุน ูุฏู ุงูุบูุฑ

## ๐ฏ ุงููุฏู
ุชูุถูุญ ูุง ูุญุฏุซ ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ ุจูุน ูู ุงูุญุงูุงุช ุงููุฎุชููุฉุ ูุนูุฏ ุนูู ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงููุ ููุง ูุญุฏุซ ูุจุถุงุฆุน ูุฏู ุงูุบูุฑ ูู ุฌููุน ุงูุญุงูุงุช.

---

## ๐ ุงูุฌุฒุก ุงูุฃูู: ุฅูุดุงุก ูุงุชูุฑุฉ ุจูุน ูู 4 ุญุงูุงุช

### 1๏ธโฃ ุญุงูุฉ: **ูุณูุฏุฉ (Draft)**

#### ูุง ูุญุฏุซ:
- โ **ูุง ูุฎุฒูู**: ูุง ูุชู ุฎุตู ุฃู ูููุงุช ูู ุงููุฎุฒูู
- โ **ูุง ูููุฏ ูุญุงุณุจูุฉ**: ูุง ูุชู ุฅูุดุงุก ุฃู ูููุฏ ูุญุงุณุจูุฉ (AR/Revenue/COGS)
- โ **ูุง ูุฏููุนุงุช**: ูุง ูููู ุชุณุฌูู ุฃู ุฏูุนุงุช
- โ **ูุง ูุฑุชุฌุน**: ูุง ูููู ุนูู ูุฑุชุฌุน
- โ **ูุงุจูุฉ ููุชุนุฏูู**: ูููู ุชุนุฏูู ุฃู ุญุฐู ุงููุงุชูุฑุฉ

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ูุง ุชูุฌุฏ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุฃู ุงููุงุชูุฑุฉ ูู ุชูุฑุณู ุจุนุฏ

---

### 2๏ธโฃ ุญุงูุฉ: **ูุฑุณูุฉ (Sent)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุฎุตู ุงููุฎุฒูู**: ูุชู ุฎุตู ุงููููุงุช ูู ุงููุฎุฒูู
- โ **ูุธุงู ุจุถุงุฆุน ูุฏู ุงูุบูุฑ** (ุฅุฐุง ูุงูุช ููุงู ุดุฑูุฉ ุดุญู):
  - ูุชู ููู ุงูุจุถุงุฆุน ูู ุงููุณุชูุฏุน โ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ
  - ูุชู ุฅูุดุงุก ุณุฌูุงุช ูู ุฌุฏูู `third_party_inventory`
  - Status: `open`
  - ูุชู ุฅูุดุงุก ุญุฑูุฉ ูุฎุฒูู ูู ููุน `sale` ูุน:
    - `from_location_type`: `warehouse`
    - `to_location_type`: `third_party`
    - `shipping_provider_id`: ูุนุฑู ุดุฑูุฉ ุงูุดุญู
- โ **ุงูููุท ุงููุจุงุดุฑ** (ุฅุฐุง ูู ุชูู ููุงู ุดุฑูุฉ ุดุญู):
  - ูุชู ุฎุตู ูุจุงุดุฑ ูู ุงููุฎุฒูู
  - ูุชู ุงุณุชุฎุฏุงู FIFO Engine + COGS Transactions

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ูุง ูููุฏ ูุญุงุณุจูุฉ**: ูุง ูุชู ุฅูุดุงุก ูููุฏ AR/Revenue/COGS
- โ **ุงูููุท ุงููุญุงุณุจู**: Cash Basis (ุงููููุฏ ุชููุดุฃ ุนูุฏ ุงูุฏูุน ููุท)

##### ุฌ) **ุงูุฏูุนุงุช:**
- โ **ูุณูุญ ุจุงูุฏูุน**: ูููู ุชุณุฌูู ุฏูุนุงุช ุฌุฒุฆูุฉ ุฃู ูุงููุฉ

##### ุฏ) **ุงููุฑุชุฌุนุงุช:**
- โ **ูุณูุญ ุจุงููุฑุชุฌุน**: ูููู ุนูู ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงูู
- โ๏ธ **ูุฑุชุฌุน Sent**: ูุฎุฒูู ููุทุ ูุง ููุฏ ูุญุงุณุจู

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุธูุฑ ูู ุตูุญุฉ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ุฅุฐุง ูุงูุช ููุงู ุดุฑูุฉ ุดุญู
- โ **Status**: `open`
- โ **cleared_quantity**: `0` (ูู ูุชู ุงูุชุตููุฉ ุจุนุฏ)
- โ **returned_quantity**: `0` (ูู ูุชู ุงููุฑุชุฌุน ุจุนุฏ)

---

### 3๏ธโฃ ุญุงูุฉ: **ูุฏููุนุฉ ุฌุฒุฆูุงู (Partially Paid)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุงููุฎุฒูู ููุฌูุฏ**: ุชู ุฎุตูู ุนูุฏ ุงูุฅุฑุณุงู (Sent)
- โ **ูุง ุชุบููุฑ ูู ุงููุฎุฒูู**: ูุง ูุชู ุฎุตู ูููุงุช ุฌุฏูุฏุฉ

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ุฅูุดุงุก ููุฏ ูุญุงุณุจู**: ูุชู ุฅูุดุงุก ููุฏ AR/Revenue ุนูุฏ ุฃูู ุฏูุนุฉ
  - **ูุฏูู**: ุญุณุงุจ AR (ุงูุฐูู ุงููุฏููุฉ)
  - **ุฏุงุฆู**: ุญุณุงุจ Revenue (ุฅูุฑุงุฏุงุช ุงููุจูุนุงุช)
  - **ูุฏูู**: ุญุณุงุจ VAT Payable (ุฅุฐุง ูุงูุช ููุงู ุถุฑูุจุฉ)
- โ **COGS**: ูุชู ุชุณุฌูู COGS ุนูุฏ ุงูุฏูุน (ุจูุณุจุฉ ุงููุจูุบ ุงููุฏููุน)
  - **ููุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุชู ุชุตููุฉ `third_party_inventory` ุจูุณุจุฉ ุงูุฏูุนุฉ
  - **ูููุฎุฒูู ุงููุจุงุดุฑ**: ูุชู ุงุณุชุฎุฏุงู FIFO Engine + COGS Transactions

##### ุฌ) **ุงูุฏูุนุงุช:**
- โ **ูุณูุญ ุจุงูุฏูุน**: ูููู ุชุณุฌูู ุฏูุนุงุช ุฅุถุงููุฉ

##### ุฏ) **ุงููุฑุชุฌุนุงุช:**
- โ **ูุณูุญ ุจุงููุฑุชุฌุน**: ูููู ุนูู ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงูู
- โ **ูุฑุชุฌุน Paid/Partial**: ูุฎุฒูู + ููุฏ ูุญุงุณุจู ุนูุณู + Customer Credit

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุธูุฑ ูู ุตูุญุฉ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ุฅุฐุง ูุงูุช ููุงู ุดุฑูุฉ ุดุญู
- โ **Status**: `partial` (ุชู ุชุตููุฉ ุฌุฒุก ูู ุงููููุฉ)
- โ **cleared_quantity**: ุฌุฒุก ูู ุงููููุฉ (ุจูุณุจุฉ ุงููุจูุบ ุงููุฏููุน)
- โ **returned_quantity**: `0` (ุฅุฐุง ูู ูุชู ุงููุฑุชุฌุน ุจุนุฏ)

---

### 4๏ธโฃ ุญุงูุฉ: **ูุฏููุนุฉ ูููุงู (Paid)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุงููุฎุฒูู ููุฌูุฏ**: ุชู ุฎุตูู ุนูุฏ ุงูุฅุฑุณุงู (Sent)
- โ **ูุง ุชุบููุฑ ูู ุงููุฎุฒูู**: ูุง ูุชู ุฎุตู ูููุงุช ุฌุฏูุฏุฉ

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ุฅูุดุงุก ููุฏ ูุญุงุณุจู**: ูุชู ุฅูุดุงุก ููุฏ AR/Revenue ุนูุฏ ุงูุฏูุน ุงููุงูู
  - **ูุฏูู**: ุญุณุงุจ AR (ุงูุฐูู ุงููุฏููุฉ)
  - **ุฏุงุฆู**: ุญุณุงุจ Revenue (ุฅูุฑุงุฏุงุช ุงููุจูุนุงุช)
  - **ูุฏูู**: ุญุณุงุจ VAT Payable (ุฅุฐุง ูุงูุช ููุงู ุถุฑูุจุฉ)
- โ **COGS**: ูุชู ุชุณุฌูู COGS ุนูุฏ ุงูุฏูุน ุงููุงูู
  - **ููุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุชู ุชุตููุฉ `third_party_inventory` ุจุงููุงูู
  - **ูููุฎุฒูู ุงููุจุงุดุฑ**: ูุชู ุงุณุชุฎุฏุงู FIFO Engine + COGS Transactions

##### ุฌ) **ุงูุฏูุนุงุช:**
- โ **ูุฏููุนุฉ ุจุงููุงูู**: ูุง ูููู ุชุณุฌูู ุฏูุนุงุช ุฅุถุงููุฉ

##### ุฏ) **ุงููุฑุชุฌุนุงุช:**
- โ **ูุณูุญ ุจุงููุฑุชุฌุน**: ูููู ุนูู ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงูู
- โ **ูุฑุชุฌุน Paid**: ูุฎุฒูู + ููุฏ ูุญุงุณุจู ุนูุณู + Customer Credit

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุธูุฑ ูู ุตูุญุฉ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ุฅุฐุง ูุงูุช ููุงู ุดุฑูุฉ ุดุญู
- โ **Status**: `cleared` (ุชู ุชุตููุฉ ุงููููุฉ ุจุงููุงูู)
- โ **cleared_quantity**: ุงููููุฉ ุงููุงููุฉ
- โ **returned_quantity**: `0` (ุฅุฐุง ูู ูุชู ุงููุฑุชุฌุน ุจุนุฏ)

---

## ๐ ุงูุฌุฒุก ุงูุซุงูู: ูุฑุชุฌุน ุฌุฒุฆู ุฃู ูุงูู ุนูู ูุงุชูุฑุฉ ุจูุน ูู 3 ุญุงูุงุช

### 1๏ธโฃ ูุฑุชุฌุน ุนูู ูุงุชูุฑุฉ **ูุฑุณูุฉ (Sent)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุฅุฑุฌุงุน ุงููุฎุฒูู**: ูุชู ุฅุฑุฌุงุน ุงููููุงุช ุงููุฑุชุฌุนุฉ ุฅูู ุงููุฎุฒูู
- โ **ุญุฑูุฉ ูุฎุฒูู**: ูุชู ุฅูุดุงุก ุญุฑูุฉ ูู ููุน `sale_return` (ูููุฉ ููุฌุจุฉ)
- โ **ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
  - ุฅุฐุง ูุงูุช ุงูุจุถุงุฆุน ูู ุจุถุงุฆุน ูุฏู ุงูุบูุฑุ ูุชู ุชุญุฏูุซ `returned_quantity`
  - Status ูุจูู `open` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ูุง ููุฏ ูุญุงุณุจู**: ูุง ูุชู ุฅูุดุงุก ุฃู ูููุฏ ูุญุงุณุจูุฉ
- โ **ุงูููุท ุงููุญุงุณุจู**: ูุฎุฒูู ููุทุ ูุง ููุฏ ูุญุงุณุจู (ูุฃู ุงููุงุชูุฑุฉ ูู ุชูุฏูุน ุจุนุฏ)

##### ุฌ) **ุชุญุฏูุซ ุงููุงุชูุฑุฉ:**
- โ **ุชุญุฏูุซ returned_amount**: ูุชู ุชุญุฏูุซ `invoices.returned_amount`
- โ **ุชุญุฏูุซ return_status**: `partial` ุฃู `full`
- โ **ุชุญุฏูุซ subtotal/tax_amount/total_amount**: ูุชู ุชุฎููุถ ุงูููู ุจูุณุจุฉ ุงููุฑุชุฌุน

##### ุฏ) **ุนูุณ COGS:**
- โ **ุนูุณ COGS Transactions**: ูุชู ุนูุณ COGS Transactions ุงูุฃุตููุฉ (FIFO)
- โ **ุนูุณ FIFO Consumption**: ูุชู ุฅุฑุฌุงุน ุงูุฏูุนุงุช ุงูุฃุตููุฉ

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุญุฏูุซ returned_quantity**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
- โ **Status**: ูุจูู `open` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)
- โ **cleared_quantity**: ูุง ูุชุบูุฑ (ูุฃู ุงููุงุชูุฑุฉ ูู ุชูุฏูุน ุจุนุฏ)

---

### 2๏ธโฃ ูุฑุชุฌุน ุนูู ูุงุชูุฑุฉ **ูุฏููุนุฉ (Paid)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุฅุฑุฌุงุน ุงููุฎุฒูู**: ูุชู ุฅุฑุฌุงุน ุงููููุงุช ุงููุฑุชุฌุนุฉ ุฅูู ุงููุฎุฒูู
- โ **ุญุฑูุฉ ูุฎุฒูู**: ูุชู ุฅูุดุงุก ุญุฑูุฉ ูู ููุน `sale_return` (ูููุฉ ููุฌุจุฉ)
- โ **ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
  - ุฅุฐุง ูุงูุช ุงูุจุถุงุฆุน ูู ุจุถุงุฆุน ูุฏู ุงูุบูุฑุ ูุชู ุชุญุฏูุซ `returned_quantity`
  - Status ูุจูู `cleared` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ุฅูุดุงุก ููุฏ ูุญุงุณุจู ุนูุณู**: ูุชู ุฅูุดุงุก ููุฏ ูุฑุชุฌุน
  - **ูุฏูู**: ุญุณุงุจ Revenue (ูุฑุฏูุฏุงุช ุงููุจูุนุงุช)
  - **ุฏุงุฆู**: ุญุณุงุจ Customer Credit (ุฑุตูุฏ ุฏุงุฆู ููุนููู)
  - **ูุฏูู**: ุญุณุงุจ VAT Payable (ุนูุณ ุถุฑูุจุฉ ุงููุจูุนุงุช)
  - **ุฏุงุฆู**: ุญุณุงุจ Customer Credit (ุฑุตูุฏ ุฏุงุฆู ููุนููู - ุถุฑูุจุฉ)
- โ **ุนูุณ COGS**: ูุชู ุนูุณ COGS Transactions ุงูุฃุตููุฉ (FIFO)
  - ูุชู ุฅูุดุงุก ููุฏ COGS ุนูุณู ุชููุงุฆูุงู ุนุจุฑ trigger

##### ุฌ) **Customer Credit:**
- โ **ุฅูุดุงุก ุฑุตูุฏ ุฏุงุฆู**: ูุชู ุฅูุดุงุก `customer_credits` ููุนููู
- โ **ุงููุจูุบ**: ูููุฉ ุงููุฑุชุฌุน (subtotal + tax)

##### ุฏ) **ุชุญุฏูุซ ุงููุงุชูุฑุฉ:**
- โ **ุชุญุฏูุซ returned_amount**: ูุชู ุชุญุฏูุซ `invoices.returned_amount`
- โ **ุชุญุฏูุซ return_status**: `partial` ุฃู `full`
- โ๏ธ **ูุง ุชุญุฏูุซ total_amount**: ูุง ูุชู ุชุญุฏูุซ `total_amount` (ููููุน ุจูุงุณุทุฉ trigger)
- โ **ุญุณุงุจ ุงููุจูุบ ุงูุฒุงุฆุฏ**: ูุชู ุญุณุงุจ `excessPayment` (ุงููุจูุบ ุงููุฏููุน - ุงููุจูุบ ุงูุฌุฏูุฏ)

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุญุฏูุซ returned_quantity**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
- โ **Status**: ูุจูู `cleared` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)
- โ **cleared_quantity**: ูุง ูุชุบูุฑ (ูุฃู ุงููุงุชูุฑุฉ ูุฏููุนุฉ)

---

### 3๏ธโฃ ูุฑุชุฌุน ุนูู ูุงุชูุฑุฉ **ูุฏููุนุฉ ุฌุฒุฆูุงู (Partially Paid)**

#### ูุง ูุญุฏุซ:

##### ุฃ) **ุงููุฎุฒูู:**
- โ **ุฅุฑุฌุงุน ุงููุฎุฒูู**: ูุชู ุฅุฑุฌุงุน ุงููููุงุช ุงููุฑุชุฌุนุฉ ุฅูู ุงููุฎุฒูู
- โ **ุญุฑูุฉ ูุฎุฒูู**: ูุชู ุฅูุดุงุก ุญุฑูุฉ ูู ููุน `sale_return` (ูููุฉ ููุฌุจุฉ)
- โ **ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
  - ุฅุฐุง ูุงูุช ุงูุจุถุงุฆุน ูู ุจุถุงุฆุน ูุฏู ุงูุบูุฑุ ูุชู ุชุญุฏูุซ `returned_quantity`
  - Status ูุจูู `partial` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)

##### ุจ) **ุงููููุฏ ุงููุญุงุณุจูุฉ:**
- โ **ุฅูุดุงุก ููุฏ ูุญุงุณุจู ุนูุณู**: ูุชู ุฅูุดุงุก ููุฏ ูุฑุชุฌุน
  - **ูุฏูู**: ุญุณุงุจ Revenue (ูุฑุฏูุฏุงุช ุงููุจูุนุงุช)
  - **ุฏุงุฆู**: ุญุณุงุจ Customer Credit (ุฑุตูุฏ ุฏุงุฆู ููุนููู)
  - **ูุฏูู**: ุญุณุงุจ VAT Payable (ุนูุณ ุถุฑูุจุฉ ุงููุจูุนุงุช)
  - **ุฏุงุฆู**: ุญุณุงุจ Customer Credit (ุฑุตูุฏ ุฏุงุฆู ููุนููู - ุถุฑูุจุฉ)
- โ **ุนูุณ COGS**: ูุชู ุนูุณ COGS Transactions ุงูุฃุตููุฉ (FIFO)
  - ูุชู ุฅูุดุงุก ููุฏ COGS ุนูุณู ุชููุงุฆูุงู ุนุจุฑ trigger

##### ุฌ) **Customer Credit:**
- โ **ุฅูุดุงุก ุฑุตูุฏ ุฏุงุฆู**: ูุชู ุฅูุดุงุก `customer_credits` ููุนููู
- โ **ุงููุจูุบ**: ูููุฉ ุงููุฑุชุฌุน (subtotal + tax)

##### ุฏ) **ุชุญุฏูุซ ุงููุงุชูุฑุฉ:**
- โ **ุชุญุฏูุซ returned_amount**: ูุชู ุชุญุฏูุซ `invoices.returned_amount`
- โ **ุชุญุฏูุซ return_status**: `partial` ุฃู `full`
- โ๏ธ **ูุง ุชุญุฏูุซ total_amount**: ูุง ูุชู ุชุญุฏูุซ `total_amount` (ููููุน ุจูุงุณุทุฉ trigger)
- โ **ุญุณุงุจ ุงููุจูุบ ุงูุฒุงุฆุฏ**: ูุชู ุญุณุงุจ `excessPayment` (ุงููุจูุบ ุงููุฏููุน - ุงููุจูุบ ุงูุฌุฏูุฏ)

#### ุจุถุงุฆุน ูุฏู ุงูุบูุฑ:
- โ **ุชุญุฏูุซ returned_quantity**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
- โ **Status**: ูุจูู `partial` ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)
- โ **cleared_quantity**: ูุง ูุชุบูุฑ (ูุฃู ุงููุงุชูุฑุฉ ูุฏููุนุฉ ุฌุฒุฆูุงู)

---

## ๐ ุฌุฏูู ููุฎุต: ูุง ูุญุฏุซ ูู ูู ุญุงูุฉ

### ุฌุฏูู 1: ุฅูุดุงุก ูุงุชูุฑุฉ ุจูุน

| ุงูุญุงูุฉ | ุงููุฎุฒูู | ุงููููุฏ ุงููุญุงุณุจูุฉ | COGS | ุงููุฏููุนุงุช | ุงููุฑุชุฌุน | ุจุถุงุฆุน ูุฏู ุงูุบูุฑ |
|--------|---------|-------------------|------|-----------|---------|-----------------|
| **Draft** | โ | โ | โ | โ | โ | โ |
| **Sent** | โ (ุฎุตู) | โ | โ | โ | โ (ูุฎุฒูู ููุท) | โ (ุฅุฐุง ูุงูุช ููุงู ุดุฑูุฉ ุดุญู) |
| **Partially Paid** | โ (ููุฌูุฏ) | โ (AR/Revenue) | โ (ุจูุณุจุฉ ุงูุฏูุนุฉ) | โ | โ (ูุฎุฒูู + ููุฏ) | โ (Status: partial) |
| **Paid** | โ (ููุฌูุฏ) | โ (AR/Revenue) | โ (ูุงูู) | โ | โ (ูุฎุฒูู + ููุฏ) | โ (Status: cleared) |

### ุฌุฏูู 2: ูุฑุชุฌุน ุนูู ูุงุชูุฑุฉ ุจูุน

| ุญุงูุฉ ุงููุงุชูุฑุฉ | ุงููุฎุฒูู | ุงููููุฏ ุงููุญุงุณุจูุฉ | Customer Credit | ุนูุณ COGS | ุจุถุงุฆุน ูุฏู ุงูุบูุฑ |
|---------------|---------|-------------------|-----------------|----------|-----------------|
| **Sent** | โ (ุฅุฑุฌุงุน) | โ | โ | โ | โ (ุชุญุฏูุซ returned_quantity) |
| **Partially Paid** | โ (ุฅุฑุฌุงุน) | โ (ููุฏ ุนูุณู) | โ | โ | โ (ุชุญุฏูุซ returned_quantity) |
| **Paid** | โ (ุฅุฑุฌุงุน) | โ (ููุฏ ุนูุณู) | โ | โ | โ (ุชุญุฏูุซ returned_quantity) |

---

## ๐ ุชูุงุตูู ุฅุถุงููุฉ: ุจุถุงุฆุน ูุฏู ุงูุบูุฑ

### ูุชู ุชุธูุฑ ุจุถุงุฆุน ูุฏู ุงูุบูุฑุ

1. โ **ูุงุชูุฑุฉ ูุจูุนุงุช (Invoice)** - ูููุณ ูุงุชูุฑุฉ ูุดุชุฑูุงุช (Bill)
2. โ **ุญุงูุฉ Sent** - ุงููุงุชูุฑุฉ ูุฌุจ ุฃู ุชููู ูุฑุณูุฉ
3. โ **ุดุฑูุฉ ุดุญู** - ูุฌุจ ุฃู ุชููู ููุงู `shipping_provider_id`
4. โ **ููุชุฌุงุช (Products)** - ูููุณ ุฎุฏูุงุช (Services)

### ูุง ูุญุฏุซ ูุจุถุงุฆุน ูุฏู ุงูุบูุฑ ูู ูู ูุฑุญูุฉ:

#### 1. ุนูุฏ ุงูุฅุฑุณุงู (Sent):
- โ **ุฅูุดุงุก ุณุฌูุงุช**: ูุชู ุฅูุดุงุก ุณุฌูุงุช ูู `third_party_inventory`
- โ **Status**: `open`
- โ **cleared_quantity**: `0`
- โ **returned_quantity**: `0`

#### 2. ุนูุฏ ุงูุฏูุน (Paid/Partially Paid):
- โ **ุชุตููุฉ**: ูุชู ุชุตููุฉ `third_party_inventory` ุจูุณุจุฉ ุงููุจูุบ ุงููุฏููุน
- โ **Status**: `partial` (ุฌุฒุฆู) ุฃู `cleared` (ูุงูู)
- โ **cleared_quantity**: ูุชู ุชุญุฏูุซู ุจูุณุจุฉ ุงูุฏูุนุฉ
- โ **COGS**: ูุชู ุชุณุฌูู COGS ุนูุฏ ุงูุชุตููุฉ

#### 3. ุนูุฏ ุงููุฑุชุฌุน:
- โ **ุชุญุฏูุซ returned_quantity**: ูุชู ุชุญุฏูุซ `third_party_inventory.returned_quantity`
- โ **Status**: ูุจูู ููุง ูู ุฃู ูุชุบูุฑ ุฅูู `returned` (ุญุณุจ ุงููููุฉ ุงููุฑุชุฌุนุฉ)
- โ **cleared_quantity**: ูุง ูุชุบูุฑ (ูุฃู ุงูุชุตููุฉ ุชูุช ุนูุฏ ุงูุฏูุน)

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงูููุท ุงููุญุงุณุจู**: ุงููุธุงู ูุณุชุฎุฏู Cash Basis - ุงููููุฏ ุงููุญุงุณุจูุฉ ุชููุดุฃ ุนูุฏ ุงูุฏูุน ููุท
2. **COGS**: ูุชู ุชุณุฌูู COGS ุนูุฏ ุงูุฏูุน (ูููุณ ุนูุฏ ุงูุฅุฑุณุงู)
3. **ุจุถุงุฆุน ูุฏู ุงูุบูุฑ**: ุชุธูุฑ ููุท ููููุงุชูุฑ ุงูุชู ููุง ุดุฑูุฉ ุดุญู
4. **ุงููุฑุชุฌุน**: ููููุงุชูุฑ ุงููุฑุณูุฉ (Sent) - ูุฎุฒูู ููุทุ ููููุงุชูุฑ ุงููุฏููุนุฉ - ูุฎุฒูู + ููุฏ ูุญุงุณุจู
5. **Customer Credit**: ูุชู ุฅูุดุงุก ุฑุตูุฏ ุฏุงุฆู ููุนููู ููุท ุนูุฏ ูุฑุชุฌุน ุงูููุงุชูุฑ ุงููุฏููุนุฉ

---

## ๐ ูููุงุช ุฐุงุช ุตูุฉ

- `lib/validation.ts` - ููุงุนุฏ ุฏูุฑุฉ ุญูุงุฉ ุงููุงุชูุฑุฉ
- `lib/sales-returns.ts` - ูุนุงูุฌุฉ ูุฑุชุฌุนุงุช ุงููุจูุนุงุช
- `lib/third-party-inventory.ts` - ุฅุฏุงุฑุฉ ุจุถุงุฆุน ูุฏู ุงูุบูุฑ
- `app/invoices/[id]/page.tsx` - ุตูุญุฉ ุชูุงุตูู ุงููุงุชูุฑุฉ
- `docs/SENT_INVOICE_RETURNS_ACCOUNTING_RULES.md` - ููุงุนุฏ ูุญุงุณุจูุฉ ูููุฑุชุฌุนุงุช

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2026-01-26
