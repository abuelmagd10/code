# ุงูููุท ุงููุญุงุณุจู ุงูุตุงุฑู ูุฃูุงูุฑ ุงูุจูุน ูุงูุดุฑุงุก

## ๐ฏ ุงููุฏู
ุชุทุจูู ููุท ูุญุงุณุจู ุงุญุชุฑุงูู ูุตุงุฑู ูุฅุฏุงุฑุฉ ุฃูุงูุฑ ุงูุจูุน ูุงูุดุฑุงุก ูุน ููุงุชูุฑูุง ุงููุฑุชุจุทุฉ.

---

## 1๏ธโฃ ุญุงูุฉ ุงููุณูุฏุฉ (Draft)

### ๐น ุฃูุงูุฑ ุงูุจูุน (Sales Orders)

**ุนูุฏ ุฅูุดุงุก ุฃูุฑ ุจูุน ูู ุญุงูุฉ ูุณูุฏุฉ:**
- โ ูุชู ุฅูุดุงุก ูุงุชูุฑุฉ ุจูุน ูุฑุชุจุทุฉ ุชููุงุฆูุงู ูู ุญุงูุฉ ูุณูุฏุฉ
- โ ุงููุงุชูุฑุฉ ูุฑุชุจุทุฉ ุจุฃูุฑ ุงูุจูุน ุนุจุฑ `sales_order_id`

**ุงููุณููุญ:**
- โ ุงูุชุนุฏูู ุฃู ุงูุญุฐู ูู ุฎูุงู ุฃูุฑ ุงูุจูุน ููุณู
- โ ุชุนุฏูู ุงููุงุชูุฑุฉ ูู ุฏุงุฎู ุฃูุฑ ุงูุจูุน ููุท
- โ ุชุญุฏูุซ ุงููููุงุช ูุงูุฃุณุนุงุฑ ูุงูุนููุงุก

**ุบูุฑ ุงููุณููุญ:**
- โ ุฅูุดุงุก ุฃู ููุฏ ูุงูู
- โ ุงูุชุฃุซูุฑ ุนูู ุงูุฐูู ุฃู ุงููุฎุฒูู
- โ ุชุนุฏูู ุงููุงุชูุฑุฉ ูุณุชููุฉ ุนู ุฃูุฑ ุงูุจูุน

### ๐น ุฃูุงูุฑ ุงูุดุฑุงุก (Purchase Orders)

**ุนูุฏ ุฅูุดุงุก ุฃูุฑ ุดุฑุงุก ูู ุญุงูุฉ ูุณูุฏุฉ:**
- โ ูุชู ุฅูุดุงุก ูุงุชูุฑุฉ ุดุฑุงุก ูุฑุชุจุทุฉ ุชููุงุฆูุงู ูู ุญุงูุฉ ูุณูุฏุฉ
- โ ุงููุงุชูุฑุฉ ูุฑุชุจุทุฉ ุจุฃูุฑ ุงูุดุฑุงุก ุนุจุฑ `purchase_order_id`

**ุงููุณููุญ:**
- โ ุงูุชุนุฏูู ุฃู ุงูุญุฐู ูู ุฎูุงู ุฃูุฑ ุงูุดุฑุงุก ููุณู
- โ ุชุนุฏูู ูุงุชูุฑุฉ ุงูุดุฑุงุก ูู ุฏุงุฎู ุฃูุฑ ุงูุดุฑุงุก ููุท

**ุบูุฑ ุงููุณููุญ:**
- โ ุฅูุดุงุก ุฃู ููุฏ ูุงูู
- โ ุงูุชุฃุซูุฑ ุนูู ุงูุฐูู ุฃู ุงููุฎุฒูู

---

## 2๏ธโฃ ุญุงูุฉ ูุฑุณูุฉ (Sent)

### ๐น ุฃูุงูุฑ ุงูุจูุน

**ุนูุฏ ุฅุฑุณุงู ูุงุชูุฑุฉ ุงูุจูุน:**
- โ ููููุน ุชุนุฏูู ุฃูุฑ ุงูุจูุน ููุงุฆูุงู
- โ ุงูุชุนุฏูู ูุชู ุนูู ุงููุงุชูุฑุฉ ููุท
- โ ุฃู ุชุนุฏูู ุนูู ุงููุงุชูุฑุฉ ููุนูุณ ุชููุงุฆูุงู ุนูู ุฃูุฑ ุงูุจูุน
- โ ูุชู ุชุญุฏูุซ ุฐูู ุงูุนููู ูุงูุฑุตูุฏ ููุท

**ููููุน:**
- ๐ซ ุฅูุดุงุก ุฃู ููุฏ ูุงูู ุฅุถุงูู
- ๐ซ ุฅูุดุงุก ููุฏ ููุฑุฑ ุฃู ุชุฃุซูุฑ ูุญุงุณุจู ุฌุงูุจู

### ๐น ุฃูุงูุฑ ุงูุดุฑุงุก

**ุนูุฏ ุฅุฑุณุงู ูุงุชูุฑุฉ ุงูุดุฑุงุก:**
- โ ููููุน ุชุนุฏูู ุฃูุฑ ุงูุดุฑุงุก ููุงุฆูุงู
- โ ุงูุชุนุฏูู ูุชู ุนูู ุงููุงุชูุฑุฉ ููุท
- โ ุฃู ุชุนุฏูู ููุนูุณ ุนูู ุฃูุฑ ุงูุดุฑุงุก
- โ ูุชู ุชุญุฏูุซ ุฐูู ุงูููุฑุฏ ูุงูุฑุตูุฏ ููุท

---

## 3๏ธโฃ ุญุงูุฉ ูุฏููุน ุฌุฒุฆูุงู ุฃู ูููุงู

### ๐น ุฃูุงูุฑ ุงูุจูุน
- โ ูููุน ุชุนุฏูู ุฃูุฑ ุงูุจูุน ููุงุฆูุงู
- โ ุฌููุน ุงูุชุนุฏููุงุช ุชุชู ูู ุฎูุงู ูุงุชูุฑุฉ ุงูุจูุน ููุท
- โ ุชุญุฏูุซ ุฐูู ุงูุนููุงุก ูุงูุฑุตูุฏ ุงููุณุชุญู/ุงููุณุฏุฏ

### ๐น ุฃูุงูุฑ ุงูุดุฑุงุก
- โ ูููุน ุชุนุฏูู ุฃูุฑ ุงูุดุฑุงุก ููุงุฆูุงู
- โ ุฌููุน ุงูุชุนุฏููุงุช ุชุชู ูู ุฎูุงู ูุงุชูุฑุฉ ุงูุดุฑุงุก ููุท
- โ ุชุญุฏูุซ ุฐูู ุงูููุฑุฏูู ูุงูุฑุตูุฏ ุงููุณุชุญู/ุงููุณุฏุฏ

---

## โ๏ธ ููุฎุต ุงููุธููุฉ (Workflow)

### ๐ค ููุธู ุงููุจูุนุงุช:
1. ููุดุฆ ุฃูุฑ ุจูุน โ ูุงุชูุฑุฉ ูุณูุฏุฉ ุชููุงุฆูุงู
2. ูุนุฏู ุงูุฃูุฑ ูู ุญุงูุฉ ุงููุณูุฏุฉ
3. ูุฑุณู ุงููุงุชูุฑุฉ โ ุงูุฃูุฑ ููุบูู ููุชุนุฏูู

### ๐ค ููุธู ุงููุดุชุฑูุงุช:
1. ููุดุฆ ุฃูุฑ ุดุฑุงุก โ ูุงุชูุฑุฉ ุดุฑุงุก ูุณูุฏุฉ ุชููุงุฆูุงู
2. ูุนุฏู ุงูุฃูุฑ ูู ุญุงูุฉ ุงููุณูุฏุฉ
3. ูุฑุณู ุงููุงุชูุฑุฉ โ ุงูุฃูุฑ ููุบูู ููุชุนุฏูู

### ๐ ูู ุญุงูุฉ ุงููุณูุฏุฉ:
- ุงูุชุนุฏูู ูุงูุญุฐู ูุณููุญ ููุท ูู ุฎูุงู ุงูุฃูุฑ
- ุงููุงุชูุฑุฉ ุชูุฏุงุฑ ูู ุฏุงุฎู ุงูุฃูุฑ

### ๐ค ุจุนุฏ ุงูุฅุฑุณุงู ุฃู ุงูุฏูุน:
- ุงูุฃูุฑ ููุบูู ููุงุฆูุงู
- ุงููุงุชูุฑุฉ ููุท ูู ููุทุฉ ุงูุชุญูู

---

## ๐ซ ุงูุชุญุฐูุฑ ุงูุฅุถุงูู (ุฅูุฒุงูู)

### ููููุน ุชูุงูุงู:
- โ ุงูุชูุงุนุจ ุจุงูููุท ุงููุญุงุณุจู
- โ ุฅูุดุงุก ูููุฏ ุบูุฑ ูุทููุจุฉ
- โ ุฃู ุชุฃุซูุฑ ุบูุฑ ูุญุณูุจ ุนูู ุงูุญุณุงุจุงุช/ุงูุฐูู/ุงููุฎุฒูู

### ูุฌุจ ุงูุงูุชุฒุงู ุงููุงูู:
- โ ุฑุจุท ุงูุนูููุงุช ุจู ุงูุดุฑูุฉ โ ุงููุฑุน โ ูุฑูุฒ ุงูุชูููุฉ โ ุงููุฎุฒู
- โ ุณุฌู ุงููุฑุงุฌุนุฉ (Audit Log) ููู ุนูููุฉ
- โ ููุน ุงูุชุนุฏูู ุจุนุฏ ุชุบููุฑ ุงูุญุงูุฉ

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ERP ุงุญุชุฑุงูู**  
โ **ุจุฏูู ุฃุฎุทุงุก ูุญุงุณุจูุฉ**  
โ **ุจุฏูู ุงุฒุฏูุงุฌ ูููุฏ**  
โ **ููุท ูุงุถุญุ ุซุงุจุชุ ููุงุจู ููุชูุณุน**

---

## ๐ง ุงูุชุทุจูู ุงูุชููู

### ููุงุนุฏ ุงูุจูุงูุงุช:
```sql
-- ููุน ุชุนุฏูู ุฃูุฑ ุงูุจูุน ุจุนุฏ ุฅุฑุณุงู ุงููุงุชูุฑุฉ
CREATE OR REPLACE FUNCTION prevent_sales_order_edit_after_sent()
RETURNS TRIGGER AS $$
BEGIN
  IF EXISTS (
    SELECT 1 FROM invoices 
    WHERE sales_order_id = NEW.id 
    AND status != 'draft'
  ) THEN
    RAISE EXCEPTION 'ูุง ูููู ุชุนุฏูู ุฃูุฑ ุงูุจูุน ุจุนุฏ ุฅุฑุณุงู ุงููุงุชูุฑุฉ ุงููุฑุชุจุทุฉ';
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- ููุน ุชุนุฏูู ุฃูุฑ ุงูุดุฑุงุก ุจุนุฏ ุฅุฑุณุงู ุงููุงุชูุฑุฉ
CREATE OR REPLACE FUNCTION prevent_purchase_order_edit_after_sent()
RETURNS TRIGGER AS $$
BEGIN
  IF EXISTS (
    SELECT 1 FROM bills 
    WHERE purchase_order_id = NEW.id 
    AND status != 'draft'
  ) THEN
    RAISE EXCEPTION 'ูุง ูููู ุชุนุฏูู ุฃูุฑ ุงูุดุฑุงุก ุจุนุฏ ุฅุฑุณุงู ุงููุงุชูุฑุฉ ุงููุฑุชุจุทุฉ';
  END IF;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;
```

### Triggers:
```sql
CREATE TRIGGER prevent_so_edit_trigger
  BEFORE UPDATE ON sales_orders
  FOR EACH ROW
  EXECUTE FUNCTION prevent_sales_order_edit_after_sent();

CREATE TRIGGER prevent_po_edit_trigger
  BEFORE UPDATE ON purchase_orders
  FOR EACH ROW
  EXECUTE FUNCTION prevent_purchase_order_edit_after_sent();
```

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2024  
**ุงูุฅุตุฏุงุฑ:** 1.0  
**ุงูุญุงูุฉ:** ูุดุท โ