# ๐ Cash Basis Accounting Pattern - MANDATORY SPECIFICATION
# ููุท ุงููุญุงุณุจุฉ ุนูู ุฃุณุงุณ ุงูููุฏูุฉ - ุงูููุงุตูุฉ ุงูุฅูุฒุงููุฉ

โ๏ธ **ูุฐุง ุงููุธุงู ูุณุชุฎุฏู Cash Basis ููุท - ูุง Accrual Basis**

**This system uses Cash Basis Accounting ONLY - No Accrual Basis.**

Any code that implements Accrual Accounting is considered a BUG and must be removed.

---

## ๐ Accounting & Inventory Pattern โ MANDATORY SPECIFICATION

ูุฐู ุงููุซููุฉ ูู **ุงููุฑุฌุน ุงููุญูุฏ (Single Source of Truth)** ููููุท ุงููุญุงุณุจู ูุงููุฎุฒูู ุงููุนุชูุฏ ูู ุงููุธุงู.
ุฃู ููุฏ ุฌุฏูุฏ (ูุงุฌูุงุชุ APIุ ุณูุฑุจุชุงุช SQLุ ุฃู ุฅุตูุงุญุงุช) **ูุฌุจ** ุฃู ููุชุฒู ุจูุฐู ุงูููุงุนุฏุ ูุฃู ุงูุญุฑุงู ุนููุง ูุนุฏ Bug.

---

### ๐ ุงูููุท ุงููุญุงุณุจู ุงูุตุงุฑู (ERP Professional)

**โ ูุง COGS ูู ุฃู ูุฑุญูุฉ**
- COGS ููุญุณุจ ุนูุฏ ุงูุญุงุฌุฉ ูู `cost_price ร quantity` ุงููุจุงุน
- ูุง ููุฏ `invoice_cogs` ุฃู `sales_return_cogs` ุฃู `credit_note_cogs`

---

### 1. Sales Invoices โ ุญุงูุงุช ุงููุงุชูุฑุฉ

**Draft**
- โ ูุง ูุชู ุฅูุดุงุก ุฃู `journal_entries`.
- โ ูุง ูุชู ุฅูุดุงุก ุฃู `inventory_transactions`.

**Sent**
- โ ูุชู ุฎุตู ุงููุฎุฒูู ูู ุฎูุงู `inventory_transactions` ูู ููุน `"sale"`.
- โ **ูุง ูุชู ุฅูุดุงุก ุฃู ููุฏ ูุญุงุณุจู** (ุงููููุฏ ุชููุดุฃ ุนูุฏ ุงูุฏูุน ููุท - Cash Basis).
- โ ูุง COGS (ููุญุณุจ ูุงุญูุงู ุนูุฏ ุงูุญุงุฌุฉ ููุชูุงุฑูุฑ).

**Paid / Partially Paid**
- โ ุฅูุดุงุก ููุฏ ุงูุฏูุน ููุท (`reference_type = 'invoice_payment'`).
- โ ูุง ุญุฑูุงุช ูุฎุฒูู ุฌุฏูุฏุฉ.
- โ ูุง COGS.

---

### 2. Sales Returns โ ูุฑุชุฌุนุงุช ููุงุชูุฑ ุงูุจูุน

**ูุฑุชุฌุน ูุงุชูุฑุฉ Sent**
- โ ุฅุนุงุฏุฉ ุงููููุงุช ุงููุฑุชุฌุนุฉ ุฅูู ุงููุฎุฒูู (`inventory_transactions` ูู ููุน `"sale_return"`).
- โ ูุง ููุฏ ูุญุงุณุจู.
- โ ูุง Customer Credit.

**ูุฑุชุฌุน ูุงุชูุฑุฉ Paid / Partially Paid**
- โ ุฅุนุงุฏุฉ ุงููููุงุช ุงููุฑุชุฌุนุฉ ุฅูู ุงููุฎุฒูู (`sale_return`).
- โ ุฅูุดุงุก ููุฏ ูุฑุชุฌุน (`reference_type = 'sales_return'`).
- โ ุฅูุดุงุก ุฑุตูุฏ ุฏุงุฆู ููุนููู (`customer_credits`) ุฅุฐุง ุงููุฏููุน > ุงูุตุงูู ุจุนุฏ ุงููุฑุชุฌุน.
- โ ูุง COGS reversal.

**Guards**
- ูููุน ุฅูุดุงุก ูุฑุชุฌุน ููุงุชูุฑุฉ ููุบุงุฉ ุฃู ุบูุฑ ูุคููุฉ ุจุญุณุจ ุญุงูุฉ ุงููุงุชูุฑุฉ.

---

### 3. Purchase Bills โ ุงูููุท ุงูุนูุณู

**Draft**
- ูุง ูููุฏ ูุญุงุณุจูุฉ ููุง ุญุฑูุงุช ูุฎุฒูู.

**Sent / Received**
- ุฒูุงุฏุฉ ุงููุฎุฒูู ููุท (`inventory_transactions` ูู ููุน `"purchase"`).
- ูุง ูุชู ุฅูุดุงุก ุฃู ูููุฏ ูุญุงุณุจูุฉ ูู ูุฐู ุงููุฑุญูุฉ.

**First Payment**
- ุฅูุดุงุก ููุฏ ุงููุงุชูุฑุฉ `reference_type = 'bill'`.
- ุฅูุดุงุก ููุฏ ุงูุฏูุน `reference_type = 'bill_payment'`.

**Subsequent Payments**
- ุฅูุดุงุก ูููุฏ ุฏูุน ููุท (`bill_payment`) ุจุฏูู ุฃู ุญุฑูุงุช ูุฎุฒูู ุฅุถุงููุฉ.

---

### 4. Purchase Returns โ Vendor Credits

- ุชูููู ุงููุฎุฒูู (`inventory_transactions` ูู ููุน `"purchase_return"`).
- ุชูููู ุญุณุงุจุงุช ุงูููุฑุฏูู `AP` (ุญุณุงุจุงุช ุฏุงุฆูุฉ).
- ุนูุณ ุถุฑูุจุฉ ุงููุดุชุฑูุงุช ุนูุฏ ูุฌูุฏูุง.

---

### 5. NonโNegotiable Guards (ูุง ูููู ุงูุชูุงุฒู ุนููุง)

ูููุน:
- ุฃู `inventory_transactions` ุจุฏูู `reference_id` ุตุญูุญ (Sale / Purchase / Returns).
- ุฃู `journal_entry` ุบูุฑ ูุชูุงุฒู (ูุฌููุน ุงููุฏูู โ ูุฌููุน ุงูุฏุงุฆู).
- ุฃู `invoice_payment` ุจุฏูู ูุฌูุฏ `invoice` ุฃุตูู.
- ุฃู COGS (`invoice_cogs` ุฃู ูุง ูุนุงุฏูู) ุจุฏูู ูุฌูุฏ ูุงุชูุฑุฉ **ูุฏููุนุฉ ุฃู ูุฏููุนุฉ ุฌุฒุฆููุง**.
- ุนูุฏ ุงูุฑุฌูุน ูู `sent` ุฅูู `draft` ุฃู `cancelled`:
  - ูุชู ุนูุณ ุงููุฎุฒูู ููุท.
  - ูุง ูุชู ุนูุณ COGS ุฅูุง ุฅุฐุง ูุงู ููุฏ COGS ููุฌูุฏูุง ุฃุตููุง.

ุฃู Feature ุฌุฏูุฏ (ุชูุงุฑูุฑุ APIุ ุฅุตูุงุญุงุชุ ETL) ูุฌุจ ุฃู ููุฑุงุฌุน ุตุฑุงุญุฉู ููุงุจู ูุฐู ุงููุซููุฉ ูุจู ุงูุฏูุฌ.


