# ุฎุทุฉ ุชุฑููุฉ ูุธุงู COGS ุฅูู ERP Professional

## ๐ ููุฎุต ุงูุชุบููุฑุงุช

### โ ุชู ุฅูุฌุงุฒู:

1. **ุฅูุดุงุก ุฌุฏูู `cogs_transactions`** โ
   - ููู: `scripts/020_create_cogs_transactions_table.sql`
   - ูุญุชูู ุนูู ุฌููุน ุงูุญููู ุงููุทููุจุฉ ููุญูููุฉ
   - RLS Policies ูุงููุฉ
   - Foreign Keys ู Constraints

2. **ุฅูุดุงุก `lib/cogs-transactions.ts`** โ
   - ุฏูุงู ูุฅูุดุงุก COGS transactions
   - ุฏูุงู ูุนูุณ COGS (ูููุฑุชุฌุนุงุช)
   - ุฏูุงู ูุญุณุงุจ ุฅุฌูุงูู COGS ูุน ุงูุญูููุฉ
   - ุฏูุงู ููุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช

3. **ุชุญุฏูุซ FIFO Engine** โ
   - ุฅุถุงูุฉ `consumeFIFOLotsWithCOGS()` 
   - ุฏูุฌ FIFO Engine ูุน cogs_transactions
   - FIFO Engine ูู ุงูุฌูุฉ ุงููุญูุฏุฉ ูุชุญุฏูุฏ unit_cost

### ๐ ุงููุทููุจ ุฅูุฌุงุฒู:

4. **ุชุญุฏูุซ Invoice Flow** ๐
   - ุงุณุชุฎุฏุงู `consumeFIFOLotsWithCOGS()` ุนูุฏ Invoice Sent
   - ุฅูุดุงุก ุณุฌูุงุช COGS ุชููุงุฆูุงู

5. **ุชุญุฏูุซ Sales Returns** ๐
   - ุงุณุชุฎุฏุงู `reverseCOGSTransaction()` ุนูุฏ ุงููุฑุชุฌุน
   - ุนูุณ COGS ุงูุฃุตูู

6. **ุชุญุฏูุซ ุงูุชูุงุฑูุฑ** ๐
   - `app/api/dashboard-stats/route.ts` - ุงุณุชุฎุฏุงู `cogs_transactions`
   - `app/api/simple-report/route.ts` - ุงุณุชุฎุฏุงู `cogs_transactions`
   - ุฌููุน ุงูุชูุงุฑูุฑ ุงูุฃุฎุฑู

7. **ุฅุถุงูุฉ Inventory Depreciation** ๐
   - ุฅูุดุงุก ุณุฌูุงุช COGS ููุฅููุงู

8. **ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช** ๐
   - ุงุณุชุฎุฏุงู `validateCOGSIntegrity()` ุฏูุฑูุงู

## ๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ

1. ุชุทุจูู SQL migration ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. ุชุญุฏูุซ invoice flow
3. ุชุญุฏูุซ sales returns
4. ุชุญุฏูุซ ุงูุชูุงุฑูุฑ
5. ุงุฎุชุจุงุฑ ุดุงูู

## โ๏ธ ููุงุญุธุงุช ูููุฉ

- **ูุง ุญุฐู ุงูููุฏ ุงููุฏูู ููุฑุงู**: ูุญุชุงุฌ ููุชูุงูู ูุน ุงูุจูุงูุงุช ุงููุฏููุฉ
- **ุงุณุชุฎุฏุงู Flag ููุชุญูู**: `estimated_cogs = true` ููุชูุงุฑูุฑ ุงูุณุฑูุนุฉ
- **ุงูุชุฏุฑูุฌ ูู ุงูุชุทุจูู**: ุชุทุจูู ุงูุชุบููุฑุงุช ุชุฏุฑูุฌูุงู ูุถูุงู ุงูุงุณุชูุฑุงุฑ
