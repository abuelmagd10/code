# ๐งช ุฏููู ุงุฎุชุจุงุฑ ูุธุงู ุงูุญูููุฉ - ERB VitaSlims

## ๐ ูุงุฆูุฉ ุงูุงุฎุชุจุงุฑุงุช

### 1๏ธโฃ ุงุฎุชุจุงุฑ ุฏูุฑ ุงูููุธู (Staff)

#### ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ูููุธู (staff)
2. ุงุฐูุจ ุฅูู ุตูุญุฉ ุฃูุงูุฑ ุงูุจูุน
3. ุชุญูู ูู ุงููุชุงุฆุฌ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ูุฑู ููุท ุฃูุงูุฑ ุงูุจูุน ุงูุชู ุฃูุดุฃูุง
- โ ูุง ูุฑู ุฃูุงูุฑ ุงูููุธููู ุงูุขุฎุฑูู
- โ ูุง ูุธูุฑ ููุชุฑ ุงูููุธููู

#### SQL ููุชุญูู:
```sql
SELECT 
  so.id, 
  so.so_number, 
  so.created_by_user_id,
  cm.role
FROM sales_orders so
JOIN company_members cm ON so.created_by_user_id = cm.user_id
WHERE cm.role = 'staff'
  AND so.created_by_user_id = '[USER_ID]';
```

---

### 2๏ธโฃ ุงุฎุชุจุงุฑ ุฏูุฑ ุงููุญุงุณุจ (Accountant)

#### ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ููุญุงุณุจ (accountant)
2. ุงุฐูุจ ุฅูู ุตูุญุฉ ุฃูุงูุฑ ุงูุจูุน
3. ุชุญูู ูู ุงููุชุงุฆุฌ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ูุฑู ุฌููุน ุฃูุงูุฑ ุงูุจูุน ูู ูุฑุนู
- โ ูุธูุฑ ููุชุฑ ุงูููุธููู
- โ ููููู ููุชุฑุฉ ุญุณุจ ููุธู ูุนูู
- โ ูุง ูุฑู ุฃูุงูุฑ ุงููุฑูุน ุงูุฃุฎุฑู

#### SQL ููุชุญูู:
```sql
SELECT 
  so.id, 
  so.so_number, 
  so.branch_id,
  cm.branch_id as user_branch
FROM sales_orders so
JOIN company_members cm ON cm.user_id = '[USER_ID]'
WHERE so.branch_id = cm.branch_id
  AND cm.role = 'accountant';
```

---

### 3๏ธโฃ ุงุฎุชุจุงุฑ ุฏูุฑ ูุฏูุฑ ุงููุฑุน (Manager)

#### ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ููุฏูุฑ ูุฑุน (manager)
2. ุงุฐูุจ ุฅูู ุตูุญุฉ ุฃูุงูุฑ ุงูุจูุน
3. ุชุญูู ูู ุงููุชุงุฆุฌ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ูุฑู ุฌููุน ุฃูุงูุฑ ุงูุจูุน ูู ูุฑุนู
- โ ูุธูุฑ ููุชุฑ ุงูููุธููู
- โ ููููู ููุชุฑุฉ ุญุณุจ ููุธู ูุนูู
- โ ูุง ูุฑู ุฃูุงูุฑ ุงููุฑูุน ุงูุฃุฎุฑู

#### SQL ููุชุญูู:
```sql
SELECT 
  so.id, 
  so.so_number, 
  so.branch_id,
  b.name as branch_name
FROM sales_orders so
JOIN branches b ON so.branch_id = b.id
JOIN company_members cm ON cm.user_id = '[USER_ID]'
WHERE so.branch_id = cm.branch_id
  AND cm.role = 'manager';
```

---

### 4๏ธโฃ ุงุฎุชุจุงุฑ ุฏูุฑ ุงููุฏูุฑ ุงูุนุงู (Owner/Admin)

#### ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ููุฏูุฑ ุนุงู (owner/admin)
2. ุงุฐูุจ ุฅูู ุตูุญุฉ ุฃูุงูุฑ ุงูุจูุน
3. ุชุญูู ูู ุงููุชุงุฆุฌ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ูุฑู ุฌููุน ุฃูุงูุฑ ุงูุจูุน ูู ุงูุดุฑูุฉ
- โ ูุธูุฑ ููุชุฑ ุงูููุธููู
- โ ูุธูุฑ ููุชุฑ ุงููุฑูุน
- โ ููููู ุฑุคูุฉ ูู ุงูุจูุงูุงุช

#### SQL ููุชุญูู:
```sql
SELECT 
  so.id, 
  so.so_number, 
  so.branch_id,
  b.name as branch_name,
  so.created_by_user_id
FROM sales_orders so
JOIN branches b ON so.branch_id = b.id
WHERE so.company_id = '[COMPANY_ID]';
```

---

### 5๏ธโฃ ุงุฎุชุจุงุฑ ุงูููุงุชูุฑ

#### ุงูุฎุทูุงุช:
1. ูุฑุฑ ููุณ ุงูุงุฎุชุจุงุฑุงุช ุฃุนูุงู ูุตูุญุฉ ุงูููุงุชูุฑ
2. ุชุญูู ูู ุฃู ุงูููุงุชุฑ ุชุนูู ุจููุณ ุงูุทุฑููุฉ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ููุณ ููุงุนุฏ ุงูุญูููุฉ ุชุทุจู ุนูู ุงูููุงุชูุฑ
- โ ุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ ุจุฃูุงูุฑ ุงูุจูุน ุชุญูู ููุณ ุจูุงูุงุช ุงูุญูููุฉ

---

### 6๏ธโฃ ุงุฎุชุจุงุฑ ุฅูุดุงุก ุฃูุฑ ุจูุน ุฌุฏูุฏ

#### ุงูุฎุทูุงุช:
1. ุณุฌู ุฏุฎูู ุจุฃู ุฏูุฑ
2. ุฃูุดุฆ ุฃูุฑ ุจูุน ุฌุฏูุฏ
3. ุชุญูู ูู ุงูุจูุงูุงุช ุงููุญููุธุฉ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ `company_id` ููููุฃ ุชููุงุฆูุงู
- โ `branch_id` ููููุฃ ูู ุจูุงูุงุช ุงููุณุชุฎุฏู
- โ `cost_center_id` ููููุฃ ูู ุจูุงูุงุช ุงููุณุชุฎุฏู
- โ `warehouse_id` ููููุฃ ูู ุงููุฎุฒู ุงูุฑุฆูุณู ูููุฑุน
- โ `created_by_user_id` ููููุฃ ุจู user_id ุงูุญุงูู

#### SQL ููุชุญูู:
```sql
SELECT 
  id,
  so_number,
  company_id,
  branch_id,
  cost_center_id,
  warehouse_id,
  created_by_user_id,
  created_at
FROM sales_orders
WHERE id = '[NEW_ORDER_ID]';
```

---

### 7๏ธโฃ ุงุฎุชุจุงุฑ ุงูุชุญููู ููุงุชูุฑุฉ

#### ุงูุฎุทูุงุช:
1. ุฃูุดุฆ ุฃูุฑ ุจูุน
2. ุญููู ููุงุชูุฑุฉ
3. ุชุญูู ูู ุจูุงูุงุช ุงููุงุชูุฑุฉ

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ ุงููุงุชูุฑุฉ ุชุญูู ููุณ `branch_id` ูู ุฃูุฑ ุงูุจูุน
- โ ุงููุงุชูุฑุฉ ุชุญูู ููุณ `cost_center_id` ูู ุฃูุฑ ุงูุจูุน
- โ ุงููุงุชูุฑุฉ ุชุญูู ููุณ `warehouse_id` ูู ุฃูุฑ ุงูุจูุน
- โ ุงููุงุชูุฑุฉ ุชุญูู ููุณ `created_by_user_id` ูู ุฃูุฑ ุงูุจูุน

#### SQL ููุชุญูู:
```sql
SELECT 
  i.id as invoice_id,
  i.branch_id as invoice_branch,
  so.branch_id as order_branch,
  i.warehouse_id as invoice_warehouse,
  so.warehouse_id as order_warehouse,
  i.created_by_user_id as invoice_creator,
  so.created_by_user_id as order_creator
FROM invoices i
JOIN sales_orders so ON i.sales_order_id = so.id
WHERE i.id = '[INVOICE_ID]';
```

---

### 8๏ธโฃ ุงุฎุชุจุงุฑ Audit Trail

#### ุงูุฎุทูุงุช:
1. ุฃูุดุฆ ุฃูุฑ ุจูุน
2. ุนุฏูู
3. ุงุญุฐูู (ุฅู ุฃููู)

#### ุงููุชุงุฆุฌ ุงููุชููุนุฉ:
- โ `created_by_user_id` ููุณุฌู ุนูุฏ ุงูุฅูุดุงุก
- โ `created_at` ููุณุฌู ุชููุงุฆูุงู
- โ `updated_at` ููุญุฏุซ ุชููุงุฆูุงู ุนูุฏ ุงูุชุนุฏูู

---

## ๐ ูููุฐุฌ ุชูุฑูุฑ ุงูุงุฎุชุจุงุฑ

| ุงูุงุฎุชุจุงุฑ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|---------|--------|-----------|
| ููุธู - ุฃูุงูุฑ ุงูุจูุน | โฌ | |
| ููุธู - ุงูููุงุชูุฑ | โฌ | |
| ูุญุงุณุจ - ุฃูุงูุฑ ุงูุจูุน | โฌ | |
| ูุญุงุณุจ - ุงูููุงุชูุฑ | โฌ | |
| ูุฏูุฑ ูุฑุน - ุฃูุงูุฑ ุงูุจูุน | โฌ | |
| ูุฏูุฑ ูุฑุน - ุงูููุงุชูุฑ | โฌ | |
| ูุฏูุฑ ุนุงู - ุฃูุงูุฑ ุงูุจูุน | โฌ | |
| ูุฏูุฑ ุนุงู - ุงูููุงุชูุฑ | โฌ | |
| ุฅูุดุงุก ุฃูุฑ ุจูุน | โฌ | |
| ุงูุชุญููู ููุงุชูุฑุฉ | โฌ | |
| Audit Trail | โฌ | |

---

## ๐ง ุฃุฏูุงุช ุงูุงุฎุชุจุงุฑ

### ุงุณุชุนูุงู ุณุฑูุน ููุชุญูู ูู ุงูุญูููุฉ:
```sql
-- ุนุฑุถ ุชูุฒูุน ุฃูุงูุฑ ุงูุจูุน ุญุณุจ ุงููุฑุน
SELECT 
  b.name as branch_name,
  COUNT(so.id) as orders_count,
  COUNT(DISTINCT so.created_by_user_id) as unique_creators
FROM sales_orders so
JOIN branches b ON so.branch_id = b.id
GROUP BY b.id, b.name
ORDER BY orders_count DESC;

-- ุนุฑุถ ุฃูุงูุฑ ุจุฏูู ุญูููุฉ
SELECT 
  id,
  so_number,
  company_id,
  branch_id,
  warehouse_id,
  created_by_user_id
FROM sales_orders
WHERE branch_id IS NULL 
   OR warehouse_id IS NULL 
   OR created_by_user_id IS NULL;
```

---

**ุขุฎุฑ ุชุญุฏูุซ**: 2024
**ุงูุญุงูุฉ**: ุฌุงูุฒ ููุงุฎุชุจุงุฑ โ
