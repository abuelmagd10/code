# ๐ฆ ุฃุนูุฏุฉ ุงูููู ูู ุตูุญุฉ ุญุงูุฉ ุงููุฎุฒูู

**ุงูุชุงุฑูุฎ**: 2026-01-23  
**ุงูุญุงูุฉ**: โ **ููุชูู**

---

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุฅุถุงูุฉ ุนููุฏูู ุฌุฏูุฏูู ูู ุตูุญุฉ ุญุงูุฉ ุงููุฎุฒูู ูุนุฑุถ ูุนูููุงุช ุงูููู ุจูู ุงููุฎุงุฒู:

1. **ุนููุฏ ุงูููู ุงููุงุฑุฏุฉ (Incoming Transfers)** - ูุนุฑุถ ุงููููุงุช ุงููุงุฏูุฉ ูู ูุฎุงุฒู ุฃุฎุฑู
2. **ุนููุฏ ุงูููู ุงูุตุงุฏุฑุฉ (Outgoing Transfers)** - ูุนุฑุถ ุงููููุงุช ุงููููููุฉ ุฅูู ูุฎุงุฒู ุฃุฎุฑู

---

## โ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ

### 1๏ธโฃ ุนููุฏ ุงูููู ุงููุงุฑุฏุฉ (Incoming Transfers)

**ุงููููุน**: ุจุนุฏ ุนููุฏ ุงููุงูู (Write-offs)

**ุงููุญุชูู**:
- ูุฌููุน ุงููููุฉ ููููุชุฌ ุงููุงุฏูุฉ ูู ุงููุฎุงุฒู ุงูุฃุฎุฑู
- ุงุณู ุงููุฎุฒู ุงููุตุฏุฑ ููู ูููุฉ
- ุตูุบุฉ ุงูุนุฑุถ: "ุงููููุฉ ูู ุงููุฎุฒู X"
- ูุซุงู: "15 ูู ูุฎุฒู ุงููุงูุฑุฉ"

**ุงูุฃููููุฉ**: `ArrowDown` (ููู ุฃุฎุถุฑ)

### 2๏ธโฃ ุนููุฏ ุงูููู ุงูุตุงุฏุฑุฉ (Outgoing Transfers)

**ุงููููุน**: ุจุนุฏ ุนููุฏ ุงูููู ุงููุงุฑุฏุฉ

**ุงููุญุชูู**:
- ูุฌููุน ุงููููุฉ ููููุชุฌ ุงููููููุฉ ุฅูู ูุฎุงุฒู ุฃุฎุฑู
- ุงุณู ุงููุฎุฒู ุงููุฌูุฉ ููู ูููุฉ
- ุตูุบุฉ ุงูุนุฑุถ: "ุงููููุฉ ุฅูู ูุฎุฒู Y"
- ูุซุงู: "20 ุฅูู ูุฎุฒู ุงูุฅุณููุฏุฑูุฉ"

**ุงูุฃููููุฉ**: `ArrowUp` (ููู ุฃุฒุฑู)

---

## ๐ ููุชุฑุฉ ุงูุตูุงุญูุงุช

### Owner/Admin
- โ ุฑุคูุฉ ุฌููุน ุงูููู ูู ุฌููุน ุงููุฎุงุฒู ุฏุงุฎู ุงูุดุฑูุฉ
- โ ุฑุคูุฉ ุงูููู ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ ูู/ุฅูู ุฃู ูุฎุฒู

### Manager (ูุฏูุฑ ุงููุฑุน)
- โ ุฑุคูุฉ ุงูููู ูู ูุฑูุนูู ููุท
- โ ุฑุคูุฉ ุงูููู ุงููุงุฑุฏุฉ ูุงูุตุงุฏุฑุฉ ูู/ุฅูู ูุฎุงุฒู ูุฑุนูู

### Store Manager (ูุณุคูู ุงููุฎุฒู)
- โ ุฑุคูุฉ ุงูููู ุงูููุฌูุฉ ููุฎุฒูู ููุท (Incoming)
- โ ุฑุคูุฉ ุงูููู ุงูุตุงุฏุฑุฉ ูู ูุฎุฒูู ููุท (Outgoing)

### Staff (ููุธู)
- โ ูุง ูุฑู ุจูุงูุงุช ุงูููู (ุญุณุจ ุงูุตูุงุญูุงุช ุงููุญุฏุฏุฉ)

---

## ๐ ุฏุนู Realtime

### ุงูุชุญุฏูุซ ุงููุญุธู

ุนูุฏ ุฃู ุชุบููุฑ ูู ุฌุฏูู `inventory_transfers`:
- โ ุฅุถุงูุฉ ููู ุฌุฏูุฏ โ ุชุญุฏูุซ ููุฑู ููุฃุนูุฏุฉ
- โ ุชุญุฏูุซ ุญุงูุฉ ุงูููู (pending โ in_transit โ received) โ ุชุญุฏูุซ ููุฑู
- โ ุญุฐู ููู โ ุชุญุฏูุซ ููุฑู

### ุงูุงุดุชุฑุงู ูู Realtime

```tsx
useRealtimeTable({
  table: 'inventory_transfers',
  enabled: !!userContext?.company_id && !!selectedWarehouseId,
  onInsert: () => loadTransferData(...),
  onUpdate: () => loadTransferData(...),
  onDelete: () => loadTransferData(...)
})
```

---

## ๐ ูุตุงุฏุฑ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงููุณุชุฎุฏูุฉ

1. **`inventory_transfers`**
   - `id` - ูุนุฑู ุงูููู
   - `source_warehouse_id` - ุงููุฎุฒู ุงููุตุฏุฑ
   - `destination_warehouse_id` - ุงููุฎุฒู ุงููุฌูุฉ
   - `status` - ุงูุญุงูุฉ (pending, in_transit, received)
   - `company_id` - ุงูุดุฑูุฉ
   - `source_branch_id` - ูุฑุน ุงููุตุฏุฑ
   - `destination_branch_id` - ูุฑุน ุงููุฌูุฉ

2. **`inventory_transfer_items`**
   - `transfer_id` - ูุนุฑู ุงูููู
   - `product_id` - ุงูููุชุฌ
   - `quantity_sent` - ุงููููุฉ ุงููุฑุณูุฉ
   - `quantity_received` - ุงููููุฉ ุงููุณุชููุฉ

3. **`warehouses`**
   - `id` - ูุนุฑู ุงููุฎุฒู
   - `name` - ุงุณู ุงููุฎุฒู

### ุงูุงุณุชุนูุงูุงุช

#### ุงูููู ุงููุงุฑุฏุฉ (Incoming)
```sql
SELECT * FROM inventory_transfers
WHERE destination_warehouse_id = :warehouseId
AND status IN ('pending', 'in_transit', 'received')
```

#### ุงูููู ุงูุตุงุฏุฑุฉ (Outgoing)
```sql
SELECT * FROM inventory_transfers
WHERE source_warehouse_id = :warehouseId
AND status IN ('pending', 'in_transit', 'received')
```

---

## ๐จ ุงูุชุตููู

### ุงูููู ุงููุงุฑุฏุฉ
- **ุงูููู**: ุฃุฎุถุฑ (green-50/green-900)
- **ุงูุฃููููุฉ**: `ArrowDown`
- **ุงูุญุฏูุฏ**: `border-green-200`

### ุงูููู ุงูุตุงุฏุฑุฉ
- **ุงูููู**: ุฃุฒุฑู (blue-50/blue-900)
- **ุงูุฃููููุฉ**: `ArrowUp`
- **ุงูุญุฏูุฏ**: `border-blue-200`

### ุนุฑุถ ุงูุชูุงุตูู
- ุนูุฏ ูุฌูุฏ ููู: ูุนุฑุถ ุงููุฌููุน + ูุงุฆูุฉ ุชูุตูููุฉ ุจูู ูุฎุฒู
- ุนูุฏ ุนุฏู ูุฌูุฏ ููู: ูุนุฑุถ "0" ุจุฎูููุฉ ุฑูุงุฏูุฉ

---

## โ ุงูููุฒุงุช

### 1. ุชุฌููุน ุงูุจูุงูุงุช
- ุชุฌููุน ุงููููุงุช ุญุณุจ ุงูููุชุฌ ูุงููุฎุฒู
- ููุน ุงูุชูุฑุงุฑ (ููุณ ุงููุฎุฒู ูู ูุธูุฑ ูุฑุชูู)

### 2. ููุชุฑุฉ ุงูุตูุงุญูุงุช
- ููุชุฑุฉ ุนูู ูุณุชูู ุงูุฎุงุฏู (Server-Side)
- ููุชุฑุฉ ุฅุถุงููุฉ ูู ุงููุงุฌูุฉ (Client-Side)

### 3. ุงูุชุญุฏูุซ ุงููุญุธู
- Realtime ููุชุญุฏูุซุงุช ุงูููุฑูุฉ
- ูุง ุญุงุฌุฉ ูู Refresh

### 4. ุงูุฃุฏุงุก
- ุงุณุชุนูุงูุงุช ูุญุณููุฉ ูุน JOIN
- ุชุฌููุน ุงูุจูุงูุงุช ูู JavaScript

---

## ๐ ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ูุซุงู 1: ููุชุฌ ูู ููู ูุงุฑุฏุฉ ูู ูุฎุฒููู

```
Incoming Transfers:
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 25                      โ โ ุงููุฌููุน
โ 15 ูู ูุฎุฒู ุงููุงูุฑุฉ     โ
โ 10 ูู ูุฎุฒู ุงูุฅุณููุฏุฑูุฉ   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ูุซุงู 2: ููุชุฌ ูู ููู ุตุงุฏุฑุฉ ุฅูู ูุฎุฒู ูุงุญุฏ

```
Outgoing Transfers:
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ 30                      โ โ ุงููุฌููุน
โ 30 ุฅูู ูุฎุฒู ุงูุฌูุฒุฉ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ูุซุงู 3: ููุชุฌ ุจุฏูู ููู

```
Incoming Transfers: 0
Outgoing Transfers: 0
```

---

## ๐ง ุงูุชุทุจูู ุงูุชููู

### State Management

```tsx
const [incomingTransfers, setIncomingTransfers] = useState<Record<string, Array<{
  quantity: number;
  warehouseName: string;
  warehouseId: string;
}>>>({})

const [outgoingTransfers, setOutgoingTransfers] = useState<Record<string, Array<{
  quantity: number;
  warehouseName: string;
  warehouseId: string;
}>>>({})
```

### ุฏุงูุฉ ุงูุฌูุจ

```tsx
const loadTransferData = async (
  context: UserContext,
  branchId: string,
  warehouseId: string,
  companyId: string
) => {
  // ุฌูุจ ุงูููู ุงููุงุฑุฏุฉ
  // ุฌูุจ ุงูููู ุงูุตุงุฏุฑุฉ
  // ููุชุฑุฉ ุญุณุจ ุงูุตูุงุญูุงุช
  // ุชุฌููุน ุงูุจูุงูุงุช
}
```

### ุงูุนุฑุถ ูู ุงูุฌุฏูู

```tsx
{incomingTransfers[product.id]?.map((transfer, idx) => (
  <div key={idx}>
    {transfer.quantity} ูู {transfer.warehouseName}
  </div>
))}
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู

- [x] ุฅุถุงูุฉ state ูุญูุธ ุจูุงูุงุช ุงูููู
- [x] ุฅูุดุงุก ุฏุงูุฉ ูุฌูุจ ุจูุงูุงุช ุงูููู ูุน ููุชุฑุฉ ุงูุตูุงุญูุงุช
- [x] ุฅุถุงูุฉ ุนููุฏูู ุฌุฏูุฏูู ูู ุงูุฌุฏูู
- [x] ุฅุถุงูุฉ Realtime ููููู
- [x] ุชุญุฏูุซ ุงูุชูุซูู
- [x] ุงุฎุชุจุงุฑ ุงูุตูุงุญูุงุช (Owner/Admin/Manager/Store Manager)
- [x] ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงููุญุธู

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ุตูุญุฉ ุงููุฎุฒูู ุชุนุฑุถ ุนููุฏูู ุฅุถุงูููู: Incoming ู Outgoing Transfers**

โ **ุชุธูุฑ ุงููููุงุช ููู ููุชุฌ ูุน ุงููุฎุฒู ุงููุฑุชุจุท**

โ **ุงูุชุญุฏูุซ ูุญุธู ุนุจุฑ Realtime**

โ **ูููุฏ ุจุงูุตูุงุญูุงุช ุญุณุจ ุงูุฏูุฑ/ุงููุฑุน/ุงููุฎุฒู**

โ **ุฃู ูุณุชุฎุฏู ูุฑู ููุท ุงููุฎุงุฒู ุงููุตุฑุญ ูู ุงููุตูู ุฅูููุง**

---

**ุงูุญุงูุฉ**: โ **ููุชูู ูุฌุงูุฒ ููุฅูุชุงุฌ**
