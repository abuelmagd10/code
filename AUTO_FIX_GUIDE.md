# ๐ง ุฏููู ุงูุฅุตูุงุญ ุงูุชููุงุฆู ูููููุฏ ุงููุญุงุณุจูุฉ ุงููุงูุตุฉ
# Auto-Fix Guide for Missing Journal Entries

**ุชุงุฑูุฎ ุงูุฅูุดุงุก:** 2025-01-XX  
**ุงููุฏู:** ุฅุตูุงุญ ุชููุงุฆู ูููููุฏ ุงููุญุงุณุจูุฉ ุงููุงูุตุฉ (18 ูุงุชูุฑุฉ + 3 ููุงุชูุฑ ุดุฑุงุก + 55 ุฏูุนุฉ)

---

## ๐ ูุธุฑุฉ ุนุงูุฉ

ูุฐุง ุงูุณูุฑุจุช ูููู ุจุฅุตูุงุญ ุชููุงุฆู ูููุดุงูู ุงูุชุงููุฉ:

1. โ **18 ูุงุชูุฑุฉ ุจุฏูู ูููุฏ ูุญุงุณุจูุฉ**
   - ุฅูุดุงุก ููุฏ AR/Revenue ููููุงุชูุฑ ุงููุฑุณูุฉ
   - ุฅูุดุงุก ููุฏ ุงูุฏูุน ููููุงุชูุฑ ุงููุฏููุนุฉ

2. โ **3 ููุงุชูุฑ ุดุฑุงุก ุจุฏูู ูููุฏ ูุญุงุณุจูุฉ**
   - ุฅูุดุงุก ููุฏ AP/Expense ุนูุฏ ุงูุฏูุน ุงูุฃูู
   - ุฅูุดุงุก ููุฏ ุงูุฏูุน

3. โ **55 ุฏูุนุฉ ุจุฏูู ูููุฏ ูุญุงุณุจูุฉ**
   - ุฅูุดุงุก ูููุฏ ุงูุฏูุน ููุฏูุนุงุช ุงููุฑุชุจุทุฉ ุจููุงุชูุฑ
   - ุฅูุดุงุก ูููุฏ ุงูุฏูุน ููุฏูุนุงุช ุงููุฑุชุจุทุฉ ุจููุงุชูุฑ ุดุฑุงุก
   - ุฅูุดุงุก ูููุฏ ุงูุฏูุน ุงูุนุงูุฉ ููุนููุงุก ูุงูููุฑุฏูู

---

## โ๏ธ ุชุญุฐูุฑุงุช ูููุฉ

### ูุจู ุงูุชูููุฐ:

1. **ุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. **ุงูุชุฃูุฏ ูู ูุฌูุฏ ุงูุญุณุงุจุงุช ุงููุทููุจุฉ**:
   - AR (Accounts Receivable)
   - AP (Accounts Payable)
   - Revenue (ุงูุฅูุฑุงุฏุงุช)
   - Expense (ุงููุตุฑููุงุช)
   - Cash (ุงูููุฏูุฉ)
   - Bank (ุงูุจูู)

3. **ูุฑุงุฌุนุฉ ุงูููุท ุงููุญุงุณุจู** ูู `docs/ACCOUNTING_PATTERN_SALES_PURCHASES.md`

### ุจุนุฏ ุงูุชูููุฐ:

1. **ุฅุนุงุฏุฉ ุชูููุฐ ุงููุฑุงุฌุนุฉ ุงููุญุงุณุจูุฉ** ููุชุฃูุฏ ูู ุญู ุงููุดุงูู
2. **ุงูุชุญูู ูู ุงูุชูุงุฒู** ูู ุฌููุน ุงูุญุณุงุจุงุช
3. **ูุฑุงุฌุนุฉ ุงูุชูุงุฑูุฑ ุงููุงููุฉ**

---

## ๐ ุทุฑููุฉ ุงูุชูููุฐ

### ุงูุทุฑููุฉ 1: Supabase SQL Editor (ููุตู ุจูุง)

1. **ูุชุญ Supabase Dashboard**
   - ุงูุฏุฎูู ุฅูู ุงููุดุฑูุน
   - Database โ SQL Editor

2. **ูุชุญ ููู SQL**
   - ูุชุญ ุงูููู: `scripts/AUTO_FIX_MISSING_JOURNAL_ENTRIES.sql`
   - ูุณุฎ ูุญุชูู ุงูููู ูุงููุงู

3. **ุชูููุฐ ูู SQL Editor**
   - ูุตู ุงููุญุชูู ูู SQL Editor
   - **ูุฑุงุฌุนุฉ ุงูุณูุฑุจุช** ูุจู ุงูุชูููุฐ
   - ุงูุถุบุท ุนูู **Run**
   - ูุฑุงูุจุฉ ุงูุฑุณุงุฆู (NOTICE) ูู ุงููุชุงุฆุฌ

4. **ุงูุชุญูู ูู ุงููุชุงุฆุฌ**
   - ุฑุงุฌุน ูุณู "ุงูุชุญูู ูู ุงููุชุงุฆุฌ" ูู ููุงูุฉ ุงูุณูุฑุจุช
   - ูุฌุจ ุฃู ุชููู ุฌููุน ุงูุฃุฑูุงู = 0

### ุงูุทุฑููุฉ 2: ุชูููุฐ ุฌุฒุฆู (ูููุฑุงุฌุนุฉ)

ูููู ุชูููุฐ ูู ูุณู ุนูู ุญุฏุฉ:

```sql
-- 1. ุฅุตูุงุญ ุงูููุงุชูุฑ ููุท
-- (ูุณุฎ ุงูุฌุฒุก ุงูุฎุงุต ุจุฅุตูุงุญ ุงูููุงุชูุฑ)

-- 2. ุฅุตูุงุญ ููุงุชูุฑ ุงูุดุฑุงุก ููุท
-- (ูุณุฎ ุงูุฌุฒุก ุงูุฎุงุต ุจุฅุตูุงุญ ููุงุชูุฑ ุงูุดุฑุงุก)

-- 3. ุฅุตูุงุญ ุงููุฏููุนุงุช ููุท
-- (ูุณุฎ ุงูุฌุฒุก ุงูุฎุงุต ุจุฅุตูุงุญ ุงููุฏููุนุงุช)
```

---

## ๐ ูุง ูููู ุจู ุงูุณูุฑุจุช

### 1. ุฅุตูุงุญ ุงูููุงุชูุฑ (18 ูุงุชูุฑุฉ)

**ููุญุงูุฉ `sent`:**
- โ ุฅูุดุงุก ููุฏ AR/Revenue:
  - AR (Debit) = total_amount
  - Revenue (Credit) = subtotal
  - VAT Payable (Credit) = tax_amount (ุฅู ูุฌุฏ)
  - Shipping (Credit) = shipping (ุฅู ูุฌุฏ)

**ููุญุงูุฉ `paid` ุฃู `partially_paid`:**
- โ ุฅูุดุงุก ููุฏ AR/Revenue (ููุง ุฃุนูุงู)
- โ ุฅูุดุงุก ููุฏ ุงูุฏูุน:
  - Cash/Bank (Debit) = paid_amount
  - AR (Credit) = paid_amount

### 2. ุฅุตูุงุญ ููุงุชูุฑ ุงูุดุฑุงุก (3 ููุงุชูุฑ)

**ููุญุงูุฉ `paid` ุฃู `partially_paid`:**
- โ ุฅูุดุงุก ููุฏ AP/Expense:
  - Expense (Debit) = subtotal
  - VAT Payable (Debit) = tax_amount (ุฅู ูุฌุฏ)
  - AP (Credit) = total_amount
- โ ุฅูุดุงุก ููุฏ ุงูุฏูุน:
  - AP (Debit) = paid_amount
  - Cash/Bank (Credit) = paid_amount

### 3. ุฅุตูุงุญ ุงููุฏููุนุงุช (55 ุฏูุนุฉ)

**ุฏูุนุฉ ูุฑุชุจุทุฉ ุจูุงุชูุฑุฉ:**
- โ ุฅูุดุงุก ููุฏ invoice_payment:
  - Cash/Bank (Debit) = amount
  - AR (Credit) = amount

**ุฏูุนุฉ ูุฑุชุจุทุฉ ุจูุงุชูุฑุฉ ุดุฑุงุก:**
- โ ุฅูุดุงุก ููุฏ bill_payment:
  - AP (Debit) = amount
  - Cash/Bank (Credit) = amount

**ุฏูุนุฉ ุนุงูุฉ (ุนููู):**
- โ ุฅูุดุงุก ููุฏ customer_payment:
  - Cash/Bank (Debit) = amount
  - AR (Credit) = amount

**ุฏูุนุฉ ุนุงูุฉ (ููุฑุฏ):**
- โ ุฅูุดุงุก ููุฏ supplier_payment:
  - AP (Debit) = amount
  - Cash/Bank (Credit) = amount

---

## ๐ Functions ุงูููุณุชุฎุฏูุฉ

### `find_company_accounts(p_company_id)`
- ุฅูุฌุงุฏ ุฌููุน ุงูุญุณุงุจุงุช ุงููุทููุจุฉ ููุดุฑูุฉ
- ุชุฑุฌุน: AR, AP, Revenue, Expense, Cash, Bank, VAT, Shipping

### `create_invoice_ar_revenue_entry(...)`
- ุฅูุดุงุก ููุฏ AR/Revenue ูููุงุชูุฑุฉ
- ูุชุนุงูู ูุน subtotal, tax, shipping ุชููุงุฆูุงู

### `create_invoice_payment_entry(...)`
- ุฅูุดุงุก ููุฏ ุงูุฏูุน ูููุงุชูุฑุฉ
- ูุญุฏุฏ Cash ุฃู Bank ุญุณุจ payment_method

### `create_bill_ap_expense_entry(...)`
- ุฅูุดุงุก ููุฏ AP/Expense ููุงุชูุฑุฉ ุงูุดุฑุงุก

### `create_bill_payment_entry(...)`
- ุฅูุดุงุก ููุฏ ุงูุฏูุน ููุงุชูุฑุฉ ุงูุดุฑุงุก

### `create_generic_payment_entry(...)`
- ุฅูุดุงุก ููุฏ ุฏูุน ุนุงู ููุนููุงุก ุฃู ุงูููุฑุฏูู

---

## โ ุงูุชุญูู ูู ุงููุฌุงุญ

ุจุนุฏ ุงูุชูููุฐุ ูุฌุจ ุฃู ุชุฑู:

```
โ ุชู ุฅุตูุงุญ 18 ูุงุชูุฑุฉ
โ ุชู ุฅุตูุงุญ 3 ูุงุชูุฑุฉ ุดุฑุงุก
โ ุชู ุฅุตูุงุญ 55 ุฏูุนุฉ
```

ููู ูุณู "ุงูุชุญูู ูู ุงููุชุงุฆุฌ":

```
remaining_invoices_without_entries: 0
remaining_bills_without_entries: 0
remaining_payments_without_entries: 0
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### 1. ุฅุนุงุฏุฉ ุชูููุฐ ุงููุฑุงุฌุนุฉ

```bash
npm run audit:comprehensive
```

ุฃู ูู Supabase SQL Editor:

```sql
-- ุชูููุฐ scripts/COMPREHENSIVE_ACCOUNTING_AUDIT.sql
```

### 2. ุงูุชุญูู ูู ุงููุชุงุฆุฌ

ูุฌุจ ุฃู ุชููู ุงููุชุงุฆุฌ:

```json
{
  "invoices_without_entries": 0,
  "bills_without_entries": 0,
  "payments_without_entries": 0
}
```

### 3. ูุฑุงุฌุนุฉ ุงูุชูุงุฑูุฑ ุงููุงููุฉ

- ุงูููุฒุงููุฉ ุงูุนููููุฉ (Balance Sheet)
- ูุงุฆูุฉ ุงูุฏุฎู (P&L)
- ุงูุชุฏููุงุช ุงูููุฏูุฉ (Cash Flow)

---

## โ๏ธ ุญู ุงููุดุงูู

### ูุดููุฉ: "ุญุณุงุจ AR ุบูุฑ ููุฌูุฏ"

**ุงูุญู:**
1. ุฅูุดุงุก ุญุณุงุจ AR ูู chart_of_accounts:
   - account_type: 'asset'
   - sub_type: 'accounts_receivable'

### ูุดููุฉ: "ุญุณุงุจ Revenue ุบูุฑ ููุฌูุฏ"

**ุงูุญู:**
1. ุฅูุดุงุก ุญุณุงุจ Revenue ูู chart_of_accounts:
   - account_type: 'income'

### ูุดููุฉ: "ุญุณุงุจ Cash/Bank ุบูุฑ ููุฌูุฏ"

**ุงูุญู:**
1. ุฅูุดุงุก ุญุณุงุจ Cash:
   - account_type: 'asset'
   - sub_type: 'cash'
2. ุฃู ุฅูุดุงุก ุญุณุงุจ Bank:
   - account_type: 'asset'
   - sub_type: 'bank'

### ูุดููุฉ: "ููุฏ ุบูุฑ ูุชูุงุฒู"

**ุงูุญู:**
- ุงูุณูุฑุจุช ูุชุญูู ุชููุงุฆูุงู ูู ุงูุชูุงุฒู
- ุฅุฐุง ุญุฏุซ ุฎุทุฃุ ุฑุงุฌุน ุงูุฑุณุงุฆู (NOTICE/WARNING) ูู ุงููุชุงุฆุฌ

---

## ๐ ููุงุญุธุงุช ูููุฉ

1. **ุงููููุฏ ุงููููุดุฃุฉ**: ุฌููุน ุงููููุฏ ุชููู `status = 'posted'` ูุจุงุดุฑุฉ

2. **ุงูุชูุงุฑูุฎ**: ุชุณุชุฎุฏู ุชุงุฑูุฎ ุงููุงุชูุฑุฉ/ุงูุฏูุนุฉ ุงูุฃุตูู

3. **ุงูุฃูุตุงู**: ุชุจุฏุฃ ุจ "ุฅุตูุงุญ ุชููุงุฆู:" ูุชุณููู ุงูุชุชุจุน

4. **ุงูุถุฑูุจุฉ ูุงูุดุญู**: ูุชู ุงูุชุนุงูู ูุนูุง ุชููุงุฆูุงู ุฅู ูุฌุฏุช ุงูุญุณุงุจุงุช

5. **ุทุฑููุฉ ุงูุฏูุน**: ุฅุฐุง ูู ุชูู ูุญุฏุฏุฉุ ูุชู ุงุณุชุฎุฏุงู 'cash' ูุงูุชุฑุงุถู

---

## ๐ฏ ุงููุชูุฌุฉ ุงููุชููุนุฉ

ุจุนุฏ ุงูุชูููุฐ ุงููุงุฌุญ:

โ **ูุธุงู ERP ูุชูุงูู ููุชูุงุฒู**
- ุฌููุน ุงูููุงุชูุฑ ููุง ูููุฏ ูุญุงุณุจูุฉ
- ุฌููุน ุงููุฏููุนุงุช ููุง ูููุฏ ูุญุงุณุจูุฉ
- ุงููุธุงู ูุชูุงุฒู ุชูุงูุงู (ุงููุฏูู = ุงูุฏุงุฆู)

โ **ูุชูุงูู ูุน Zoho Books**
- ููุณ ุงูููุท ุงููุญุงุณุจู
- ููุณ ุงูุชุตูููุงุช
- ููุณ ุงูููุงุนุฏ

โ **ุฌุงูุฒ ููุงุณุชุฎุฏุงู ุงูุชุฌุงุฑู**
- ุจูุงูุงุช ุฏูููุฉ
- ุชูุงุฑูุฑ ุตุญูุญุฉ
- ูุงุนุฏุฉ ุจูุงูุงุช ุณูููุฉ

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. ุฑุงุฌุน ุงูุฑุณุงุฆู (NOTICE/WARNING) ูู ูุชุงุฆุฌ SQL
2. ุฑุงุฌุน ููู `AUDIT_RESULTS_ANALYSIS.md`
3. ุฑุงุฌุน ุงูููุท ุงููุญุงุณุจู ูู `docs/ACCOUNTING_PATTERN_SALES_PURCHASES.md`

---

**ุขุฎุฑ ุชุญุฏูุซ:** 2025-01-XX

